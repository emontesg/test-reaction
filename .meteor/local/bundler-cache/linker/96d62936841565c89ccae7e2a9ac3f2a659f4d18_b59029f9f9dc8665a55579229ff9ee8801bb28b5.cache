[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Accounts = Package['accounts-base'].Accounts;\nvar OAuth = Package.oauth.OAuth;\nvar Oauth = Package.oauth.Oauth;\nvar Template = Package['templating-runtime'].Template;\nvar Random = Package.random.Random;\nvar ServiceConfiguration = Package['service-configuration'].ServiceConfiguration;\nvar Blaze = Package.blaze.Blaze;\nvar UI = Package.blaze.UI;\nvar Handlebars = Package.blaze.Handlebars;\nvar Spacebars = Package.spacebars.Spacebars;\nvar HTML = Package.htmljs.HTML;\n\n/* Package-scope variables */\nvar Knowledge, scope;\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                     //\n// packages/knowledgeio_accounts-knowledge/knowledge_client.js                                         //\n//                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                       //\nKnowledge = {};\n\nKnowledge.requestCredential = function (options, credentialRequestCompleteCallback) {\n  if (!credentialRequestCompleteCallback && typeof options === 'function') {\n    credentialRequestCompleteCallback = options;\n    options = {};\n  }\n\n  var config = ServiceConfiguration.configurations.findOne({ service: 'knowledge' });\n\n  if (!config) {\n    if (credentialRequestCompleteCallback) {\n      credentialRequestCompleteCallback(new ServiceConfiguration.ConfigError());\n    }\n\n    return;\n  }\n\n  var credentialToken = Random.secret();\n  var loginStyle = OAuth._loginStyle('knowledge', config, options);\n\n  if (typeof scope === 'string') {\n    scope = [scope];\n  }\n\n  var flatScope = _.map(scope, encodeURIComponent).join('+');\n  var credentialToken = Random.secret();\n  var absoluteUrlOptions = {};\n  var rootUrl = this.rootUrl();\n  if (rootUrl) {\n    absoluteUrlOptions.rootUrl = rootUrl;\n  }\n\n  var uri = OAuth._redirectUri('knowledge', config, null, absoluteUrlOptions);\n  var oidc_scope = \"openid email roles profile\";\n  var oidc_clientid = \"knowledge-code\";\n  var redUrl = \"https://store.local.knowledge.io/_oauth/knowledge\";\n  var state = OAuth._stateParam(loginStyle, credentialToken);\n  var loginUrl2 = \"https://accounts.play.knowledge.io/auth?response_type=id_token%20token&client_id=knowledge&scope=openid+email&redirect_uri=\" + redUrl + \"&nonce=09382a4b9cf540bc9fb5fb29db632b01\";\n  var loginUrl = \"https://accounts.play.knowledge.io/auth?\" + \"response_type=code&client_id=\" + oidc_clientid + \"&scope=\" + oidc_scope + \"&redirect_uri=\" + redUrl + \"&state=\" + state + \"&nonce=zwPLUqogyue3HbSRdhQ8SenA79H3yNfntYxGNObw0lk&display=popup\";\n  OAuth.launchLogin({\n    loginService: \"knowledge\",\n    loginStyle: loginStyle,\n    loginUrl: loginUrl,\n    credentialRequestCompleteCallback: credentialRequestCompleteCallback,\n    credentialToken: credentialToken\n  });\n};\n\n\n// override this method to set the root redirect URL\n// useful for multi-tenant environments\nKnowledge.rootUrl = function () { /* noop */ };\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                     //\n// packages/knowledgeio_accounts-knowledge/knowledge.js                                                //\n//                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                       //\nAccounts.oauth.registerService('knowledge');\n\nif (Meteor.isClient) {\n  Meteor.loginWithKnowledge = function (options, callback) {\n    // support a callback without options\n    if (!callback && typeof options === \"function\") {\n      callback = options;\n      options = null;\n    }\n    var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback);\n\n    Knowledge.requestCredential(options, credentialRequestCompleteCallback);\n  };\n} else {\n  Accounts.addAutopublishFields({\n    forLoggedInUser: ['services.knowledge'],\n    forOtherUsers: [\n      'services.knowledge.username',\n      'services.knowledge.full_name',\n      'services.knowledge.profile_picture'\n    ]\n  });\n}\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                     //\n// packages/knowledgeio_accounts-knowledge/template.knowledge_configuration.js                         //\n//                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                       //\n\nTemplate.__checkName(\"configureLoginServiceDialogForKnowledge\");\nTemplate[\"configureLoginServiceDialogForKnowledge\"] = new Template(\"Template.configureLoginServiceDialogForKnowledge\", (function() {\n  var view = this;\n  return [ HTML.Raw(\"<p>\\n        Follow these steps to configure your Untappd client:\\n    </p>\\n    \"), HTML.OL(\"\\n        \", HTML.LI(\"\\n            Set Callback URL to: \", HTML.SPAN({\n    \"class\": \"url\"\n  }, Blaze.View(function() {\n    return Spacebars.mustache(view.lookup(\"siteUrl\"));\n  }), \"_oauth/untappd\"), \"\\n        \"), \"\\n    \") ];\n}));\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function(){\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                     //\n// packages/knowledgeio_accounts-knowledge/knowledge_configuration.js                                  //\n//                                                                                                     //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                       //\nTemplate.configureLoginServiceDialogForKnowledge.helpers({\n  siteUrl: function () {\n    return Meteor.absoluteUrl();\n  }\n});\n\nTemplate.configureLoginServiceDialogForKnowledge.fields = function () {\n  return [\n    { property: 'clientId', label: 'Client Id' },\n    { property: 'secret', label: 'Client Secret' }\n  ];\n};\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"knowledgeio:accounts-knowledge\", {\n  Knowledge: Knowledge\n});\n\n})();\n","servePath":"/packages/knowledgeio_accounts-knowledge.js"}]