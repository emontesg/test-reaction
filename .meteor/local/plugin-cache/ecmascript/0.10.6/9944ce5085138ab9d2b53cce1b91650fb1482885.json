{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/accounts/client/containers/verifyAccount.js","filename":"imports/plugins/core/accounts/client/containers/verifyAccount.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/accounts/client/containers/verifyAccount.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/accounts/client/containers/verifyAccount.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/accounts/client/containers/verifyAccount.js"}},"code":"var Accounts;\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function (v) {\n    Accounts = v;\n  }\n}, 0);\nvar ReactiveVar;\nmodule.watch(require(\"meteor/reactive-var\"), {\n  ReactiveVar: function (v) {\n    ReactiveVar = v;\n  }\n}, 1);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 2);\nvar registerComponent, composeWithTracker;\nmodule.watch(require(\"../../../components/lib\"), {\n  registerComponent: function (v) {\n    registerComponent = v;\n  },\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 3);\nvar VerifyAccount;\nmodule.watch(require(\"../components/verifyAccount\"), {\n  \"default\": function (v) {\n    VerifyAccount = v;\n  }\n}, 4);\nvar Reaction;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 5);\nvar verified = new ReactiveVar(null);\nAccounts.onEmailVerificationLink(function (token, done) {\n  Accounts.verifyEmail(token, function (error) {\n    if (error) {\n      verified.set({\n        error: {\n          reason: error.reason // no i18nKey for framework errors for now\n\n        }\n      });\n    } else {\n      verified.set(true);\n    }\n\n    Reaction.Router.go(\"account/verify\");\n    done();\n  });\n});\n\nfunction wrapper(props, onData) {\n  Meteor.setTimeout(function () {\n    if (!verified.get()) {\n      onData(null, {\n        error: {\n          defaultValue: \"Verification timed out. Probably you've already been verified successfully.\",\n          i18nKey: \"accountsUI.error.verifyTimeout\"\n        }\n      });\n      Meteor.setTimeout(function () {\n        Reaction.Router.go(\"/\");\n      }, 2000);\n    }\n  }, 5000);\n  var user = Meteor.user();\n\n  if (user && verified.get() === true) {\n    for (var _iterator = user.emails, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var _email = _ref;\n\n      if (_email.verified === true) {\n        Meteor.call(\"accounts/verifyAccount\", function (error, affectedDocs) {\n          if (error) {\n            onData(null, {\n              error: {\n                reason: error.reason // no i18nKey for framework errors for now\n\n              }\n            });\n            return;\n          }\n\n          if (affectedDocs === 0) {\n            onData(null, {\n              error: {\n                reason: \"Couldn't verify email address.\",\n                i18nKey: \"accountsUI.error.verifyEmailAddressNotFound\"\n              }\n            });\n            return;\n          } // Success\n\n\n          onData(null, {});\n        });\n      }\n    }\n  }\n\n  onData(null, verified.get());\n}\n\nregisterComponent(\"VerifyAccount\", VerifyAccount, composeWithTracker(wrapper));","map":{"version":3,"sources":["imports/plugins/core/accounts/client/containers/verifyAccount.js"],"names":["Accounts","module","watch","require","v","ReactiveVar","Meteor","registerComponent","composeWithTracker","VerifyAccount","Reaction","verified","onEmailVerificationLink","token","done","verifyEmail","error","set","reason","Router","go","wrapper","props","onData","setTimeout","get","defaultValue","i18nKey","user","emails","email","call","affectedDocs"],"mappings":"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","sourcesContent":["import { Accounts } from \"meteor/accounts-base\";\nimport { ReactiveVar } from \"meteor/reactive-var\";\nimport { Meteor } from \"meteor/meteor\";\nimport { registerComponent, composeWithTracker } from \"@reactioncommerce/reaction-components\";\nimport VerifyAccount from \"../components/verifyAccount\";\nimport { Reaction } from \"/client/api\";\n\n\nconst verified = new ReactiveVar(null);\n\nAccounts.onEmailVerificationLink((token, done) => {\n  Accounts.verifyEmail(token, (error) => {\n    if (error) {\n      verified.set({\n        error: {\n          reason: error.reason\n          // no i18nKey for framework errors for now\n        }\n      });\n    } else {\n      verified.set(true);\n    }\n    Reaction.Router.go(\"account/verify\");\n    done();\n  });\n});\n\nfunction wrapper(props, onData) {\n  Meteor.setTimeout(() => {\n    if (!verified.get()) {\n      onData(null, {\n        error: {\n          defaultValue: \"Verification timed out. Probably you've already been verified successfully.\",\n          i18nKey: \"accountsUI.error.verifyTimeout\"\n        }\n      });\n      Meteor.setTimeout(() => {\n        Reaction.Router.go(\"/\");\n      }, 2000);\n    }\n  }, 5000);\n\n  const user = Meteor.user();\n  if (user && verified.get() === true) {\n    for (const email of user.emails) {\n      if (email.verified === true) {\n        Meteor.call(\"accounts/verifyAccount\", (error, affectedDocs) => {\n          if (error) {\n            onData(null, {\n              error: {\n                reason: error.reason\n                // no i18nKey for framework errors for now\n              }\n            });\n            return;\n          }\n          if (affectedDocs === 0) {\n            onData(null, {\n              error: {\n                reason: \"Couldn't verify email address.\",\n                i18nKey: \"accountsUI.error.verifyEmailAddressNotFound\"\n              }\n            });\n            return;\n          }\n          // Success\n          onData(null, {});\n        });\n      }\n    }\n  }\n  onData(null, verified.get());\n}\n\nregisterComponent(\"VerifyAccount\", VerifyAccount, composeWithTracker(wrapper));\n"]},"sourceType":"script","hash":"9944ce5085138ab9d2b53cce1b91650fb1482885"}
