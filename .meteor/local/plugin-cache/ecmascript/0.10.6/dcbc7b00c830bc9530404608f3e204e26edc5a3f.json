{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/included/product-admin/client/containers/productAdmin.js","filename":"imports/plugins/included/product-admin/client/containers/productAdmin.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/included/product-admin/client/containers/productAdmin.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/included/product-admin/client/containers/productAdmin.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/included/product-admin/client/containers/productAdmin.js"}},"code":"var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _compose;\n\nmodule.watch(require(\"recompose/compose\"), {\n  \"default\": function (v) {\n    _compose = v;\n  }\n}, 0);\n\nvar _map;\n\nmodule.watch(require(\"lodash/map\"), {\n  \"default\": function (v) {\n    _map = v;\n  }\n}, 1);\n\nvar _isArray;\n\nmodule.watch(require(\"lodash/isArray\"), {\n  \"default\": function (v) {\n    _isArray = v;\n  }\n}, 2);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 3);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 4);\nvar registerComponent, composeWithTracker;\nmodule.watch(require(\"../../../../core/components/lib\"), {\n  registerComponent: function (v) {\n    registerComponent = v;\n  },\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 5);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 6);\nvar Reaction;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 7);\nvar getPrimaryMediaForItem, ReactionProduct;\nmodule.watch(require(\"../../../../../../lib/api\"), {\n  getPrimaryMediaForItem: function (v) {\n    getPrimaryMediaForItem = v;\n  },\n  ReactionProduct: function (v) {\n    ReactionProduct = v;\n  }\n}, 8);\nvar Tags, Templates;\nmodule.watch(require(\"../../../../../../lib/collections\"), {\n  Tags: function (v) {\n    Tags = v;\n  },\n  Templates: function (v) {\n    Templates = v;\n  }\n}, 9);\nvar Countries;\nmodule.watch(require(\"../../../../../../client/collections\"), {\n  Countries: function (v) {\n    Countries = v;\n  }\n}, 10);\nvar ProductAdmin;\nmodule.watch(require(\"../components\"), {\n  ProductAdmin: function (v) {\n    ProductAdmin = v;\n  }\n}, 11);\n\nvar wrapComponent = function (Comp) {\n  var _class, _temp;\n\n  return _temp = _class =\n  /*#__PURE__*/\n  function (_Component) {\n    (0, _inheritsLoose2.default)(ProductAdminContainer, _Component);\n\n    function ProductAdminContainer(props) {\n      var _this;\n\n      _this = _Component.call(this, props) || this;\n\n      _this.handleCardExpand = function (cardName) {\n        Reaction.state.set(\"edit/focus\", cardName);\n      };\n\n      _this.handleDeleteProduct = function (product) {\n        ReactionProduct.archiveProduct(product || _this.product);\n      };\n\n      _this.handleProductFieldSave = function (productId, fieldName, value) {\n        var updateValue = value; // special case, slugify handles.\n\n        if (fieldName === \"handle\") {\n          updateValue = Reaction.getSlug(value);\n        }\n\n        Meteor.call(\"products/updateProductField\", productId, fieldName, updateValue, function (error) {\n          if (error) {\n            Alerts.toast(error.message, \"error\");\n\n            _this.forceUpdate();\n          }\n        });\n      };\n\n      _this.handleMetaChange = function (metafield) {\n        var newState = {\n          newMetafield: metafield\n        };\n\n        _this.setState(newState);\n      };\n\n      _this.handleMetafieldSave = function (productId, metafield, index) {\n        // update existing metafield\n        if (index >= 0) {\n          Meteor.call(\"products/updateMetaFields\", productId, metafield, index);\n        } else if (metafield.key && metafield.value) {\n          Meteor.call(\"products/updateMetaFields\", productId, metafield);\n        }\n\n        _this.setState({\n          newMetafield: {\n            key: \"\",\n            value: \"\"\n          }\n        });\n      };\n\n      _this.handleMetaRemove = function (productId, metafield) {\n        Meteor.call(\"products/removeMetaFields\", productId, metafield);\n      };\n\n      _this.handleProductRestore = function (product) {\n        Meteor.call(\"products/updateProductField\", product._id, \"isDeleted\", false);\n      };\n\n      _this.state = {\n        newMetafield: {\n          key: \"\",\n          value: \"\"\n        }\n      };\n      return _this;\n    }\n\n    var _proto = ProductAdminContainer.prototype;\n\n    _proto.render = function () {\n      function render() {\n        return React.createElement(Comp, (0, _extends2.default)({\n          newMetafield: this.state.newMetafield,\n          onCardExpand: this.handleCardExpand,\n          onDeleteProduct: this.handleDeleteProduct,\n          onMetaChange: this.handleMetaChange,\n          onMetaRemove: this.handleMetaRemove,\n          onMetaSave: this.handleMetafieldSave,\n          onProductFieldSave: this.handleProductFieldSave,\n          onRestoreProduct: this.handleProductRestore\n        }, this.props));\n      }\n\n      return render;\n    }();\n\n    return ProductAdminContainer;\n  }(Component), _class.propTypes = {\n    product: PropTypes.object,\n    tags: PropTypes.arrayOf(PropTypes.object)\n  }, _temp;\n};\n\nfunction composer(props, onData) {\n  var product = ReactionProduct.selectedProduct();\n  var editable = Reaction.hasAdminAccess();\n  var tags;\n  var media;\n  var revisonDocumentIds;\n\n  if (product) {\n    if (_isArray(product.hashtags)) {\n      tags = _map(product.hashtags, function (id) {\n        return Tags.findOne(id);\n      });\n    }\n\n    var selectedVariant = ReactionProduct.selectedVariant();\n\n    if (selectedVariant) {\n      media = getPrimaryMediaForItem({\n        productId: product._id,\n        variantId: selectedVariant._id\n      });\n    }\n\n    revisonDocumentIds = [product._id];\n    var templates = Templates.find({\n      parser: \"react\",\n      provides: \"template\",\n      templateFor: {\n        $in: [\"pdp\"]\n      },\n      enabled: true\n    }).map(function (template) {\n      return {\n        label: template.title,\n        value: template.name\n      };\n    });\n    var countries = Countries.find({}).fetch();\n    onData(null, {\n      editFocus: Reaction.state.get(\"edit/focus\") || \"productDetails\",\n      product: product,\n      media: media,\n      tags: tags,\n      revisonDocumentIds: revisonDocumentIds,\n      templates: templates,\n      countries: countries,\n      editable: editable\n    });\n  } else {\n    onData(null, {\n      editFocus: Reaction.state.get(\"edit/focus\") || \"productDetails\"\n    });\n  }\n}\n\nregisterComponent(\"ProductAdmin\", ProductAdmin, [composeWithTracker(composer), wrapComponent]); // Decorate component and export\n\nmodule.exportDefault(_compose(composeWithTracker(composer), wrapComponent)(ProductAdmin));","map":{"version":3,"sources":["imports/plugins/included/product-admin/client/containers/productAdmin.js"],"names":["_compose","module","watch","require","v","_map","_isArray","React","Component","PropTypes","registerComponent","composeWithTracker","Meteor","Reaction","getPrimaryMediaForItem","ReactionProduct","Tags","Templates","Countries","ProductAdmin","wrapComponent","Comp","props","handleCardExpand","cardName","state","set","handleDeleteProduct","product","archiveProduct","handleProductFieldSave","productId","fieldName","value","updateValue","getSlug","call","error","Alerts","toast","message","forceUpdate","handleMetaChange","metafield","newState","newMetafield","setState","handleMetafieldSave","index","key","handleMetaRemove","handleProductRestore","_id","render","propTypes","object","tags","arrayOf","composer","onData","selectedProduct","editable","hasAdminAccess","media","revisonDocumentIds","hashtags","id","findOne","selectedVariant","variantId","templates","find","parser","provides","templateFor","$in","enabled","map","template","label","title","name","countries","fetch","editFocus","get","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport _ from \"lodash\";\nimport { compose } from \"recompose\";\nimport { registerComponent, composeWithTracker } from \"@reactioncommerce/reaction-components\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Reaction } from \"/client/api\";\nimport { getPrimaryMediaForItem, ReactionProduct } from \"/lib/api\";\nimport { Tags, Templates } from \"/lib/collections\";\nimport { Countries } from \"/client/collections\";\nimport { ProductAdmin } from \"../components\";\n\nconst wrapComponent = (Comp) => (\n  class ProductAdminContainer extends Component {\n    static propTypes = {\n      product: PropTypes.object,\n      tags: PropTypes.arrayOf(PropTypes.object)\n    }\n\n    constructor(props) {\n      super(props);\n\n      this.state = {\n        newMetafield: {\n          key: \"\",\n          value: \"\"\n        }\n      };\n    }\n\n    handleCardExpand = (cardName) => {\n      Reaction.state.set(\"edit/focus\", cardName);\n    }\n\n    handleDeleteProduct = (product) => {\n      ReactionProduct.archiveProduct(product || this.product);\n    }\n\n    handleProductFieldSave = (productId, fieldName, value) => {\n      let updateValue = value;\n      // special case, slugify handles.\n      if (fieldName === \"handle\") {\n        updateValue = Reaction.getSlug(value);\n      }\n      Meteor.call(\"products/updateProductField\", productId, fieldName, updateValue, (error) => {\n        if (error) {\n          Alerts.toast(error.message, \"error\");\n          this.forceUpdate();\n        }\n      });\n    }\n\n\n    handleMetaChange = (metafield) => {\n      const newState = {\n        newMetafield: metafield\n      };\n\n      this.setState(newState);\n    }\n\n    handleMetafieldSave = (productId, metafield, index) => {\n      // update existing metafield\n      if (index >= 0) {\n        Meteor.call(\"products/updateMetaFields\", productId, metafield, index);\n      } else if (metafield.key && metafield.value) {\n        Meteor.call(\"products/updateMetaFields\", productId, metafield);\n      }\n\n      this.setState({\n        newMetafield: {\n          key: \"\",\n          value: \"\"\n        }\n      });\n    }\n\n    handleMetaRemove = (productId, metafield) => {\n      Meteor.call(\"products/removeMetaFields\", productId, metafield);\n    }\n\n    handleProductRestore = (product) => {\n      Meteor.call(\"products/updateProductField\", product._id, \"isDeleted\", false);\n    }\n\n    render() {\n      return (\n        <Comp\n          newMetafield={this.state.newMetafield}\n          onCardExpand={this.handleCardExpand}\n          onDeleteProduct={this.handleDeleteProduct}\n          onMetaChange={this.handleMetaChange}\n          onMetaRemove={this.handleMetaRemove}\n          onMetaSave={this.handleMetafieldSave}\n          onProductFieldSave={this.handleProductFieldSave}\n          onRestoreProduct={this.handleProductRestore}\n          {...this.props}\n        />\n      );\n    }\n  }\n);\n\nfunction composer(props, onData) {\n  const product = ReactionProduct.selectedProduct();\n  const editable = Reaction.hasAdminAccess();\n  let tags;\n  let media;\n  let revisonDocumentIds;\n\n  if (product) {\n    if (_.isArray(product.hashtags)) {\n      tags = _.map(product.hashtags, (id) => Tags.findOne(id));\n    }\n\n    const selectedVariant = ReactionProduct.selectedVariant();\n\n    if (selectedVariant) {\n      media = getPrimaryMediaForItem({\n        productId: product._id,\n        variantId: selectedVariant._id\n      });\n    }\n\n    revisonDocumentIds = [product._id];\n\n    const templates = Templates.find({\n      parser: \"react\",\n      provides: \"template\",\n      templateFor: { $in: [\"pdp\"] },\n      enabled: true\n    }).map((template) => ({\n      label: template.title,\n      value: template.name\n    }));\n\n    const countries = Countries.find({}).fetch();\n\n    onData(null, {\n      editFocus: Reaction.state.get(\"edit/focus\") || \"productDetails\",\n      product,\n      media,\n      tags,\n      revisonDocumentIds,\n      templates,\n      countries,\n      editable\n    });\n  } else {\n    onData(null, {\n      editFocus: Reaction.state.get(\"edit/focus\") || \"productDetails\"\n    });\n  }\n}\n\nregisterComponent(\"ProductAdmin\", ProductAdmin, [\n  composeWithTracker(composer),\n  wrapComponent\n]);\n\n// Decorate component and export\nexport default compose(\n  composeWithTracker(composer),\n  wrapComponent\n)(ProductAdmin);\n"]},"sourceType":"script","hash":"dcbc7b00c830bc9530404608f3e204e26edc5a3f"}
