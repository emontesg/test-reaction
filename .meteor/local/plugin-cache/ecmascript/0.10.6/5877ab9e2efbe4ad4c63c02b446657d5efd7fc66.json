{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/revisions/client/components/publishControls.js","filename":"imports/plugins/core/revisions/client/components/publishControls.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/revisions/client/components/publishControls.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/revisions/client/components/publishControls.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/revisions/client/components/publishControls.js"}},"code":"var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 0);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 1);\nvar Components;\nmodule.watch(require(\"../../../components/lib\"), {\n  Components: function (v) {\n    Components = v;\n  }\n}, 2);\nvar Button, FlatButton, IconButton, Divider, DropDownMenu, MenuItem, Switch, Icon;\nmodule.watch(require(\"../../../ui/client/components\"), {\n  Button: function (v) {\n    Button = v;\n  },\n  FlatButton: function (v) {\n    FlatButton = v;\n  },\n  IconButton: function (v) {\n    IconButton = v;\n  },\n  Divider: function (v) {\n    Divider = v;\n  },\n  DropDownMenu: function (v) {\n    DropDownMenu = v;\n  },\n  MenuItem: function (v) {\n    MenuItem = v;\n  },\n  Switch: function (v) {\n    Switch = v;\n  },\n  Icon: function (v) {\n    Icon = v;\n  }\n}, 3);\nvar SimpleDiff;\nmodule.watch(require(\"./simpleDiff\"), {\n  \"default\": function (v) {\n    SimpleDiff = v;\n  }\n}, 4);\nvar Translatable;\nmodule.watch(require(\"../../../ui/client/providers\"), {\n  Translatable: function (v) {\n    Translatable = v;\n  }\n}, 5);\nvar Reaction;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 6);\n\nvar PublishControls =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inheritsLoose2.default)(PublishControls, _Component);\n\n  function PublishControls(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.handleVisibilityChange = function (event, value) {\n      if (_this.props.onVisibilityChange) {\n        var isDocumentVisible = false;\n\n        if (value === \"public\") {\n          isDocumentVisible = true;\n        }\n\n        _this.props.onVisibilityChange(event, isDocumentVisible, _this.props.documentIds);\n      }\n    };\n\n    _this.handleAction = function (event, value) {\n      if (_this.props.onAction) {\n        _this.props.onAction(event, value, _this.props.documentIds);\n      }\n    };\n\n    _this.onViewContextChange = function (event, isChecked) {\n      if (typeof _this.props.onViewContextChange === \"function\") {\n        _this.props.onViewContextChange(event, isChecked ? \"customer\" : \"administrator\");\n      }\n    };\n\n    _this.state = {\n      showDiffs: false\n    };\n    _this.handleToggleShowChanges = _this.handleToggleShowChanges.bind((0, _assertThisInitialized2.default)(_this));\n    _this.handlePublishClick = _this.handlePublishClick.bind((0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  var _proto = PublishControls.prototype;\n\n  _proto.handleToggleShowChanges = function () {\n    function handleToggleShowChanges() {\n      this.setState({\n        showDiffs: !this.state.showDiffs\n      });\n    }\n\n    return handleToggleShowChanges;\n  }();\n\n  _proto.handlePublishClick = function () {\n    function handlePublishClick() {\n      if (this.props.onPublishClick) {\n        this.props.onPublishClick(this.props.revisions);\n      }\n    }\n\n    return handlePublishClick;\n  }();\n\n  _proto.renderChanges = function () {\n    function renderChanges() {\n      if (this.showDiffs) {\n        var diffs = this.props.revisions.map(function (revision) {\n          return React.createElement(SimpleDiff, {\n            diff: revision.diff,\n            key: revision._id\n          });\n        });\n        return React.createElement(\"div\", null, diffs);\n      }\n\n      return null;\n    }\n\n    return renderChanges;\n  }();\n\n  _proto.renderDeletionStatus = function () {\n    function renderDeletionStatus() {\n      if (this.hasChanges) {\n        if (this.primaryRevision && this.primaryRevision.documentData.isDeleted) {\n          return React.createElement(Button, {\n            label: \"Archived\",\n            onClick: this.handleRestore,\n            status: \"danger\",\n            i18nKeyLabel: \"app.archived\"\n          });\n        }\n      }\n\n      return null;\n    }\n\n    return renderDeletionStatus;\n  }();\n\n  _proto.renderPublishButton = function () {\n    function renderPublishButton() {\n      var buttonProps = {};\n\n      if (Array.isArray(this.props.documentIds) && this.props.documentIds.length > 1) {\n        buttonProps.label = \"Publish All\";\n        buttonProps.i18nKeyLabel = \"toolbar.publishAll\";\n      }\n\n      var isDisabled = Array.isArray(this.props.documentIds) && this.props.documentIds.length === 0;\n      return React.createElement(\"div\", {\n        className: \"hidden-xs\"\n      }, React.createElement(Button, (0, _extends2.default)({\n        bezelStyle: \"outline\",\n        disabled: isDisabled,\n        label: \"Publish\",\n        onClick: this.handlePublishClick,\n        status: \"success\",\n        tooltip: \"This product has changes that need to be published before they are visible to your customers.\",\n        i18nKeyLabel: \"productDetailEdit.publish\"\n      }, buttonProps)));\n    }\n\n    return renderPublishButton;\n  }();\n\n  _proto.renderMoreOptionsButton = function () {\n    function renderMoreOptionsButton() {\n      return React.createElement(DropDownMenu, {\n        buttonElement: React.createElement(IconButton, {\n          icon: \"fa fa-ellipsis-v\"\n        }),\n        handleMenuItemChange: this.handleAction\n      }, React.createElement(MenuItem, {\n        label: \"Administrator\",\n        value: \"administrator\"\n      }), React.createElement(MenuItem, {\n        label: \"Customer\",\n        value: \"customer\"\n      }), React.createElement(Divider, null), React.createElement(MenuItem, {\n        i18nKeyLabel: \"app.public\",\n        icon: \"fa fa-unlock\",\n        label: \"Public\",\n        selectLabel: \"Public\",\n        value: \"public\"\n      }), React.createElement(MenuItem, {\n        i18nKeyLabel: \"app.private\",\n        label: \"Private\",\n        icon: \"fa fa-lock\",\n        selectLabel: \"Public\",\n        value: \"private\"\n      }), React.createElement(Divider, null), React.createElement(MenuItem, {\n        disabled: this.hasChanges === false,\n        i18nKeyLabel: \"revisions.discardChanges\",\n        icon: \"fa fa-undo\",\n        label: \"Discard Changes\",\n        value: \"discard\"\n      }), React.createElement(Divider, null), React.createElement(MenuItem, {\n        i18nKeyLabel: \"app.archive\",\n        icon: \"fa fa-trash-o\",\n        label: \"Archive\",\n        value: \"archive\"\n      }));\n    }\n\n    return renderMoreOptionsButton;\n  }();\n\n  _proto.renderViewControls = function () {\n    function renderViewControls() {\n      if (this.props.showViewAsControls) {\n        var tooltip = \"Private\";\n        var i18nKeyTooltip = \"app.private\";\n\n        if (this.isVisible === \"public\") {\n          tooltip = \"Public\";\n          i18nKeyTooltip = \"app.public\";\n        }\n\n        return React.createElement(\"div\", {\n          className: \"hidden-xs\"\n        }, React.createElement(FlatButton, {\n          i18nKeyTooltip: i18nKeyTooltip,\n          icon: \"fa fa-eye-slash\",\n          onIcon: \"fa fa-eye\",\n          toggle: true,\n          tooltip: tooltip,\n          value: \"public\",\n          onValue: \"private\",\n          toggleOn: this.isVisible === \"public\",\n          onToggle: this.handleVisibilityChange\n        }));\n      }\n\n      return null;\n    }\n\n    return renderViewControls;\n  }();\n\n  _proto.renderUndoButton = function () {\n    function renderUndoButton() {\n      return React.createElement(FlatButton, {\n        disabled: this.hasChanges === false,\n        tooltip: \"Discard Changes\",\n        i18nKeyTooltip: \"revisions.discardChanges\",\n        icon: \"fa fa-undo\",\n        value: \"discard\",\n        onClick: this.handleAction\n      });\n    }\n\n    return renderUndoButton;\n  }();\n\n  _proto.renderArchiveButton = function () {\n    function renderArchiveButton() {\n      return React.createElement(FlatButton, {\n        tooltip: \"Archive\",\n        i18nKeyTooltip: \"app.archive\",\n        icon: \"fa fa-archive\",\n        value: \"archive\",\n        onClick: this.handleAction\n      });\n    }\n\n    return renderArchiveButton;\n  }();\n\n  _proto.renderSettingsButton = function () {\n    function renderSettingsButton() {\n      return React.createElement(FlatButton, {\n        icon: \"fa fa-cog\",\n        value: \"settings\",\n        onClick: this.handleAction\n      });\n    }\n\n    return renderSettingsButton;\n  }();\n\n  _proto.renderVisibilitySwitch = function () {\n    function renderVisibilitySwitch() {\n      return React.createElement(Switch, {\n        i18nKeyLabel: \"admin.dashboard.preview\",\n        label: \"Preview\",\n        checked: this.props.isPreview,\n        onChange: this.onViewContextChange\n      });\n    }\n\n    return renderVisibilitySwitch;\n  }();\n\n  _proto.renderAdminButton = function () {\n    function renderAdminButton() {\n      return React.createElement(FlatButton, {\n        onClick: function () {\n          Reaction.showActionView({\n            i18nKeyTitle: \"dashboard.coreTitle\",\n            title: \"Dashboard\",\n            template: \"dashboardPackages\"\n          });\n        }\n      }, React.createElement(Icon, {\n        style: {\n          fontSize: 24\n        },\n        icon: \"icon icon-reaction-logo\"\n      }));\n    }\n\n    return renderAdminButton;\n  }();\n\n  _proto.renderAddButton = function () {\n    function renderAddButton() {\n      return React.createElement(FlatButton, {\n        i18nKeyTooltip: \"app.shortcut.addProduct\",\n        icon: \"fa fa-plus\",\n        tooltip: \"Add Product\",\n        onClick: this.props.onAddProduct\n      });\n    }\n\n    return renderAddButton;\n  }();\n\n  _proto.render = function () {\n    function render() {\n      if (this.props.isEnabled) {\n        return React.createElement(Components.ToolbarGroup, {\n          lastChild: true\n        }, this.renderDeletionStatus(), this.renderUndoButton(), this.renderArchiveButton(), this.renderViewControls(), this.renderPublishButton());\n      }\n\n      return null;\n    }\n\n    return render;\n  }();\n\n  (0, _createClass2.default)(PublishControls, [{\n    key: \"showChangesButtonLabel\",\n    get: function () {\n      if (!this.showDiffs) {\n        return \"Show Changes\";\n      }\n\n      return \"Hide Changes\";\n    }\n  }, {\n    key: \"showChangesButtoni18nKeyLabel\",\n    get: function () {\n      if (!this.showDiffs) {\n        return \"app.showChanges\";\n      }\n\n      return \"app.hideChanges\";\n    }\n  }, {\n    key: \"primaryRevision\",\n    get: function () {\n      var revisions = this.props.revisions;\n\n      if (Array.isArray(revisions) && revisions.length) {\n        var primaryDocumentId = this.props.documentIds[0];\n        return revisions.find(function (revision) {\n          return revision.documentId === primaryDocumentId;\n        });\n      }\n\n      return false;\n    }\n  }, {\n    key: \"revisionIds\",\n    get: function () {\n      if (this.hasRevisions) {\n        return this.props.revisions.map(function (revision) {\n          return revision._id;\n        });\n      }\n\n      return false;\n    }\n  }, {\n    key: \"hasRevisions\",\n    get: function () {\n      return Array.isArray(this.props.revisions) && this.props.revisions.length;\n    }\n  }, {\n    key: \"diffs\",\n    get: function () {\n      return this.props.revisions;\n    }\n  }, {\n    key: \"showDiffs\",\n    get: function () {\n      return this.diffs && this.state.showDiffs;\n    }\n  }, {\n    key: \"isVisible\",\n    get: function () {\n      if (Array.isArray(this.props.revisions) && this.props.revisions.length && this.primaryRevision) {\n        var primaryRevisionObj = this.primaryRevision;\n\n        if (primaryRevisionObj.documentData.isVisible) {\n          return \"public\";\n        }\n      } else if (Array.isArray(this.props.documents) && this.props.documents.length) {\n        var primaryDocument = this.props.documents[0];\n\n        if (primaryDocument.isVisible) {\n          return \"public\";\n        }\n      }\n\n      return \"private\";\n    }\n    /**\n     * Getter hasChanges\n     * @return {Boolean} one or more revision has changes\n     */\n\n  }, {\n    key: \"hasChanges\",\n    get: function () {\n      // Verify we even have any revision at all\n      if (this.hasRevisions) {\n        // Loop through all revisions to determine if they have changes\n        var diffHasActualChanges = this.props.revisions.map(function (revision) {\n          // We probably do have chnages to publish\n          // Note: Sometimes \"updatedAt\" will cause false positives, but just incase, lets\n          // enable the publish button anyway.\n          if (Array.isArray(revision.diff) && revision.diff.length || revision.documentType !== \"product\") {\n            return true;\n          } // If all else fails, we will disable the button\n\n\n          return false;\n        }); // If even one revision has changes we should enable the publish button\n\n        return diffHasActualChanges.some(function (element) {\n          return element === true;\n        });\n      } // No revisions, no publishing\n\n\n      return false;\n    }\n  }]);\n  return PublishControls;\n}(Component);\n\nPublishControls.propTypes = {\n  documentIds: PropTypes.arrayOf(PropTypes.string),\n  documents: PropTypes.arrayOf(PropTypes.object),\n  isEnabled: PropTypes.bool,\n  isPreview: PropTypes.bool,\n  onAction: PropTypes.func,\n  onAddProduct: PropTypes.func,\n  onPublishClick: PropTypes.func,\n  onViewContextChange: PropTypes.func,\n  onVisibilityChange: PropTypes.func,\n  revisions: PropTypes.arrayOf(PropTypes.object),\n  showViewAsControls: PropTypes.bool,\n  translation: PropTypes.shape({\n    lang: PropTypes.string\n  })\n};\nPublishControls.defaultProps = {\n  showViewAsControls: true\n};\nmodule.exportDefault(Translatable()(PublishControls));","map":{"version":3,"sources":["imports/plugins/core/revisions/client/components/publishControls.js"],"names":["React","Component","module","watch","require","v","PropTypes","Components","Button","FlatButton","IconButton","Divider","DropDownMenu","MenuItem","Switch","Icon","SimpleDiff","Translatable","Reaction","PublishControls","props","handleVisibilityChange","event","value","onVisibilityChange","isDocumentVisible","documentIds","handleAction","onAction","onViewContextChange","isChecked","state","showDiffs","handleToggleShowChanges","bind","handlePublishClick","setState","onPublishClick","revisions","renderChanges","diffs","map","revision","diff","_id","renderDeletionStatus","hasChanges","primaryRevision","documentData","isDeleted","handleRestore","renderPublishButton","buttonProps","Array","isArray","length","label","i18nKeyLabel","isDisabled","renderMoreOptionsButton","renderViewControls","showViewAsControls","tooltip","i18nKeyTooltip","isVisible","renderUndoButton","renderArchiveButton","renderSettingsButton","renderVisibilitySwitch","isPreview","renderAdminButton","showActionView","i18nKeyTitle","title","template","fontSize","renderAddButton","onAddProduct","render","isEnabled","primaryDocumentId","find","documentId","hasRevisions","primaryRevisionObj","documents","primaryDocument","diffHasActualChanges","documentType","some","element","propTypes","arrayOf","string","object","bool","func","translation","shape","lang","defaultProps","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Components } from \"@reactioncommerce/reaction-components\";\nimport {\n  Button,\n  FlatButton,\n  IconButton,\n  Divider,\n  DropDownMenu,\n  MenuItem,\n  Switch,\n  Icon\n} from \"/imports/plugins/core/ui/client/components\";\nimport SimpleDiff from \"./simpleDiff\";\nimport { Translatable } from \"/imports/plugins/core/ui/client/providers\";\n\n/** TMP **/\nimport { Reaction } from \"/client/api\";\n\nclass PublishControls extends Component {\n  static propTypes = {\n    documentIds: PropTypes.arrayOf(PropTypes.string),\n    documents: PropTypes.arrayOf(PropTypes.object),\n    isEnabled: PropTypes.bool,\n    isPreview: PropTypes.bool,\n    onAction: PropTypes.func,\n    onAddProduct: PropTypes.func,\n    onPublishClick: PropTypes.func,\n    onViewContextChange: PropTypes.func,\n    onVisibilityChange: PropTypes.func,\n    revisions: PropTypes.arrayOf(PropTypes.object),\n    showViewAsControls: PropTypes.bool,\n    translation: PropTypes.shape({\n      lang: PropTypes.string\n    })\n  }\n\n  static defaultProps = {\n    showViewAsControls: true\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      showDiffs: false\n    };\n\n    this.handleToggleShowChanges = this.handleToggleShowChanges.bind(this);\n    this.handlePublishClick = this.handlePublishClick.bind(this);\n  }\n\n  handleToggleShowChanges() {\n    this.setState({\n      showDiffs: !this.state.showDiffs\n    });\n  }\n\n  handlePublishClick() {\n    if (this.props.onPublishClick) {\n      this.props.onPublishClick(this.props.revisions);\n    }\n  }\n\n  handleVisibilityChange = (event, value) => {\n    if (this.props.onVisibilityChange) {\n      let isDocumentVisible = false;\n\n      if (value === \"public\") {\n        isDocumentVisible = true;\n      }\n\n      this.props.onVisibilityChange(event, isDocumentVisible, this.props.documentIds);\n    }\n  }\n\n  handleAction = (event, value) => {\n    if (this.props.onAction) {\n      this.props.onAction(event, value, this.props.documentIds);\n    }\n  }\n\n  onViewContextChange = (event, isChecked) => {\n    if (typeof this.props.onViewContextChange === \"function\") {\n      this.props.onViewContextChange(event, isChecked ? \"customer\" : \"administrator\");\n    }\n  }\n\n  get showChangesButtonLabel() {\n    if (!this.showDiffs) {\n      return \"Show Changes\";\n    }\n\n    return \"Hide Changes\";\n  }\n\n  get showChangesButtoni18nKeyLabel() {\n    if (!this.showDiffs) {\n      return \"app.showChanges\";\n    }\n\n    return \"app.hideChanges\";\n  }\n\n  get primaryRevision() {\n    const { revisions } = this.props;\n    if (Array.isArray(revisions) && revisions.length) {\n      const primaryDocumentId = this.props.documentIds[0];\n      return revisions.find((revision) => revision.documentId === primaryDocumentId);\n    }\n    return false;\n  }\n\n  get revisionIds() {\n    if (this.hasRevisions) {\n      return this.props.revisions.map((revision) => revision._id);\n    }\n    return false;\n  }\n\n  get hasRevisions() {\n    return Array.isArray(this.props.revisions) && this.props.revisions.length;\n  }\n\n  get diffs() {\n    return this.props.revisions;\n  }\n\n  get showDiffs() {\n    return this.diffs && this.state.showDiffs;\n  }\n\n  get isVisible() {\n    if (Array.isArray(this.props.revisions) && this.props.revisions.length && this.primaryRevision) {\n      const primaryRevisionObj = this.primaryRevision;\n\n      if (primaryRevisionObj.documentData.isVisible) {\n        return \"public\";\n      }\n    } else if (Array.isArray(this.props.documents) && this.props.documents.length) {\n      const primaryDocument = this.props.documents[0];\n\n      if (primaryDocument.isVisible) {\n        return \"public\";\n      }\n    }\n\n    return \"private\";\n  }\n\n  /**\n   * Getter hasChanges\n   * @return {Boolean} one or more revision has changes\n   */\n  get hasChanges() {\n    // Verify we even have any revision at all\n    if (this.hasRevisions) {\n      // Loop through all revisions to determine if they have changes\n      const diffHasActualChanges = this.props.revisions.map((revision) => {\n        // We probably do have chnages to publish\n        // Note: Sometimes \"updatedAt\" will cause false positives, but just incase, lets\n        // enable the publish button anyway.\n        if ((Array.isArray(revision.diff) && revision.diff.length) || revision.documentType !== \"product\") {\n          return true;\n        }\n\n        // If all else fails, we will disable the button\n        return false;\n      });\n\n      // If even one revision has changes we should enable the publish button\n      return diffHasActualChanges.some((element) => element === true);\n    }\n\n    // No revisions, no publishing\n    return false;\n  }\n\n  renderChanges() {\n    if (this.showDiffs) {\n      const diffs = this.props.revisions.map((revision) => <SimpleDiff diff={revision.diff} key={revision._id} />);\n\n      return (\n        <div>\n          {diffs}\n        </div>\n      );\n    }\n    return null;\n  }\n\n  renderDeletionStatus() {\n    if (this.hasChanges) {\n      if (this.primaryRevision && this.primaryRevision.documentData.isDeleted) {\n        return (\n          <Button\n            label=\"Archived\"\n            onClick={this.handleRestore}\n            status=\"danger\"\n            i18nKeyLabel=\"app.archived\"\n          />\n        );\n      }\n    }\n\n    return null;\n  }\n\n  renderPublishButton() {\n    const buttonProps = {};\n\n    if (Array.isArray(this.props.documentIds) && this.props.documentIds.length > 1) {\n      buttonProps.label = \"Publish All\";\n      buttonProps.i18nKeyLabel = \"toolbar.publishAll\";\n    }\n\n    const isDisabled = Array.isArray(this.props.documentIds) && this.props.documentIds.length === 0;\n\n    return (\n      <div className=\"hidden-xs\">\n        <Button\n          bezelStyle=\"outline\"\n          disabled={isDisabled}\n          label=\"Publish\"\n          onClick={this.handlePublishClick}\n          status=\"success\"\n          tooltip={\"This product has changes that need to be published before they are visible to your customers.\"}\n          i18nKeyLabel=\"productDetailEdit.publish\"\n          {...buttonProps}\n        />\n      </div>\n    );\n  }\n\n  renderMoreOptionsButton() {\n    return (\n      <DropDownMenu\n        buttonElement={<IconButton icon={\"fa fa-ellipsis-v\"}/>}\n        handleMenuItemChange={this.handleAction}\n      >\n        <MenuItem label=\"Administrator\" value=\"administrator\" />\n        <MenuItem label=\"Customer\" value=\"customer\" />\n        <Divider />\n        <MenuItem\n          i18nKeyLabel=\"app.public\"\n          icon=\"fa fa-unlock\"\n          label=\"Public\"\n          selectLabel=\"Public\"\n          value=\"public\"\n        />\n        <MenuItem\n          i18nKeyLabel=\"app.private\"\n          label=\"Private\"\n          icon=\"fa fa-lock\"\n          selectLabel=\"Public\"\n          value=\"private\"\n        />\n        <Divider />\n        <MenuItem\n          disabled={this.hasChanges === false}\n          i18nKeyLabel=\"revisions.discardChanges\"\n          icon=\"fa fa-undo\"\n          label=\"Discard Changes\"\n          value=\"discard\"\n        />\n        <Divider />\n        <MenuItem\n          i18nKeyLabel=\"app.archive\"\n          icon=\"fa fa-trash-o\"\n          label=\"Archive\"\n          value=\"archive\"\n        />\n      </DropDownMenu>\n    );\n  }\n\n  renderViewControls() {\n    if (this.props.showViewAsControls) {\n      let tooltip = \"Private\";\n      let i18nKeyTooltip = \"app.private\";\n\n      if (this.isVisible === \"public\") {\n        tooltip = \"Public\";\n        i18nKeyTooltip = \"app.public\";\n      }\n\n      return (\n        <div className=\"hidden-xs\">\n          <FlatButton\n            i18nKeyTooltip={i18nKeyTooltip}\n            icon=\"fa fa-eye-slash\"\n            onIcon=\"fa fa-eye\"\n            toggle={true}\n            tooltip={tooltip}\n            value=\"public\"\n            onValue=\"private\"\n            toggleOn={this.isVisible === \"public\"}\n            onToggle={this.handleVisibilityChange}\n          />\n        </div>\n      );\n    }\n\n    return null;\n  }\n\n  renderUndoButton() {\n    return (\n      <FlatButton\n        disabled={this.hasChanges === false}\n        tooltip=\"Discard Changes\"\n        i18nKeyTooltip=\"revisions.discardChanges\"\n        icon={\"fa fa-undo\"}\n        value=\"discard\"\n        onClick={this.handleAction}\n      />\n    );\n  }\n\n  renderArchiveButton() {\n    return (\n      <FlatButton\n        tooltip=\"Archive\"\n        i18nKeyTooltip=\"app.archive\"\n        icon={\"fa fa-archive\"}\n        value=\"archive\"\n        onClick={this.handleAction}\n      />\n    );\n  }\n\n  renderSettingsButton() {\n    return (\n      <FlatButton\n        icon={\"fa fa-cog\"}\n        value=\"settings\"\n        onClick={this.handleAction}\n      />\n    );\n  }\n\n  renderVisibilitySwitch() {\n    return (\n      <Switch\n        i18nKeyLabel={\"admin.dashboard.preview\"}\n        label={\"Preview\"}\n        checked={this.props.isPreview}\n        onChange={this.onViewContextChange}\n      />\n    );\n  }\n\n  renderAdminButton() {\n    return (\n      <FlatButton\n        onClick={() => {\n          Reaction.showActionView({\n            i18nKeyTitle: \"dashboard.coreTitle\",\n            title: \"Dashboard\",\n            template: \"dashboardPackages\"\n          });\n        }}\n      >\n        <Icon style={{ fontSize: 24 }} icon=\"icon icon-reaction-logo\" />\n      </FlatButton>\n    );\n  }\n\n  renderAddButton() {\n    return (\n      <FlatButton\n        i18nKeyTooltip={\"app.shortcut.addProduct\"}\n        icon={\"fa fa-plus\"}\n        tooltip={\"Add Product\"}\n        onClick={this.props.onAddProduct}\n      />\n    );\n  }\n\n  render() {\n    if (this.props.isEnabled) {\n      return (\n        <Components.ToolbarGroup lastChild={true}>\n          {this.renderDeletionStatus()}\n          {this.renderUndoButton()}\n          {this.renderArchiveButton()}\n          {this.renderViewControls()}\n          {this.renderPublishButton()}\n          {/* this.renderMoreOptionsButton() */}\n        </Components.ToolbarGroup>\n      );\n    }\n\n    return null;\n  }\n}\n\nexport default Translatable()(PublishControls);\n"]},"sourceType":"script","hash":"5877ab9e2efbe4ad4c63c02b446657d5efd7fc66"}
