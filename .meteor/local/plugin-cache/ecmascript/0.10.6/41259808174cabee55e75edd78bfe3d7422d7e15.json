{"metadata":{},"options":{"plugins":[{"key":"base$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"base$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$2","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$3","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$4","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"transform-meteor-async-await","visitor":{"AwaitExpression":{"enter":[null]},"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{"useNativeAsyncAwait":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"base$0$9","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$10","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}}],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"lib/collections/schemas/products.js","filename":"lib/collections/schemas/products.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"presets":[],"parserOpts":{"sourceType":"module","sourceFileName":"lib/collections/schemas/products.js","plugins":["jsx","jsx","flow","flow","objectRestSpread","objectRestSpread","dynamicImport","asyncGenerators","classProperties"]},"generatorOpts":{"filename":"lib/collections/schemas/products.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"lib/collections/schemas/products.js"}},"code":"module.export({\n  VariantMedia: () => VariantMedia,\n  ProductPosition: () => ProductPosition,\n  ProductVariant: () => ProductVariant,\n  PriceRange: () => PriceRange,\n  Product: () => Product\n});\nlet SimpleSchema;\nmodule.watch(require(\"simpl-schema\"), {\n  default(v) {\n    SimpleSchema = v;\n  }\n\n}, 0);\nlet check;\nmodule.watch(require(\"meteor/check\"), {\n  check(v) {\n    check = v;\n  }\n\n}, 1);\nlet Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 2);\nlet Random;\nmodule.watch(require(\"meteor/random\"), {\n  Random(v) {\n    Random = v;\n  }\n\n}, 3);\nlet Tracker;\nmodule.watch(require(\"meteor/tracker\"), {\n  Tracker(v) {\n    Tracker = v;\n  }\n\n}, 4);\nlet registerSchema;\nmodule.watch(require(\"@reactioncommerce/schemas\"), {\n  registerSchema(v) {\n    registerSchema = v;\n  }\n\n}, 5);\nlet ReactionProduct, getSlug;\nmodule.watch(require(\"../../api\"), {\n  ReactionProduct(v) {\n    ReactionProduct = v;\n  },\n\n  getSlug(v) {\n    getSlug = v;\n  }\n\n}, 6);\nlet createdAtAutoValue, shopIdAutoValue, shopDefaultCountry, updatedAtAutoValue;\nmodule.watch(require(\"./helpers\"), {\n  createdAtAutoValue(v) {\n    createdAtAutoValue = v;\n  },\n\n  shopIdAutoValue(v) {\n    shopIdAutoValue = v;\n  },\n\n  shopDefaultCountry(v) {\n    shopDefaultCountry = v;\n  },\n\n  updatedAtAutoValue(v) {\n    updatedAtAutoValue = v;\n  }\n\n}, 7);\nlet Event;\nmodule.watch(require(\"./event\"), {\n  Event(v) {\n    Event = v;\n  }\n\n}, 8);\nlet Metafield;\nmodule.watch(require(\"./metafield\"), {\n  Metafield(v) {\n    Metafield = v;\n  }\n\n}, 9);\nlet ShippingParcel;\nmodule.watch(require(\"./shipping\"), {\n  ShippingParcel(v) {\n    ShippingParcel = v;\n  }\n\n}, 10);\nlet Workflow;\nmodule.watch(require(\"./workflow\"), {\n  Workflow(v) {\n    Workflow = v;\n  }\n\n}, 11);\nconst VariantMedia = new SimpleSchema({\n  \"mediaId\": {\n    type: String,\n    optional: true\n  },\n  \"priority\": {\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"updatedAt\": {\n    type: Date,\n    optional: true\n  },\n  \"createdAt\": {\n    type: Date,\n    autoValue: createdAtAutoValue\n  }\n}, {\n  check,\n  tracker: Tracker\n});\nregisterSchema(\"VariantMedia\", VariantMedia);\n/**\n * @name ProductPosition\n * @memberof schemas\n * @type {SimpleSchema}\n * @property {String} tag optional\n * @property {Number} position optional\n * @property {Boolean} pinned optional\n * @property {Number} weight optional, default value: `0`\n * @property {Date} updatedAt required\n */\n\nconst ProductPosition = new SimpleSchema({\n  tag: {\n    type: String,\n    optional: true\n  },\n  position: {\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  pinned: {\n    type: Boolean,\n    optional: true\n  },\n  weight: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    defaultValue: 0,\n    min: 0,\n    max: 3\n  },\n  updatedAt: {\n    type: Date\n  }\n}, {\n  check,\n  tracker: Tracker\n});\nregisterSchema(\"ProductPosition\", ProductPosition);\n/**\n * @name ProductVariant\n * @memberof schemas\n * @type {SimpleSchema}\n * @property {String} _id required, Variant ID\n * @property {String[]} ancestors, default value: `[]`\n * @property {Number} index optional, Variant position number in list. Keep array index for moving variants in a list.\n * @property {Boolean} isVisible, default value: `false`\n * @property {Boolean} isDeleted, default value: `false`\n * @property {String} barcode optional\n * @property {Number} compareAtPrice optional, Compare at price\n * @property {String} fulfillmentService optional, Fullfillment service\n * @property {Number} weight, default value: `0`\n * @property {Number} length optional, default value: `0`\n * @property {Number} width optional, default value: `0`\n * @property {Number} height optional, default value: `0`\n * @property {Boolean} inventoryManagement, default value: `true`\n * @property {Boolean} inventoryPolicy, default value: `false`, If disabled, item can be sold even if it not in stock.\n * @property {Number} lowInventoryWarningThreshold, default value: `0`, Warn of low inventory at this number\n * @property {Number} inventoryQuantity, default value: `0`\n * @property {Number} minOrderQuantity optional\n * @property {Boolean} isLowQuantity optional, true when at least 1 variant is below `lowInventoryWarningThreshold`\n * @property {Boolean} isSoldOut optional, denormalized field, indicates when all variants `inventoryQuantity` is 0\n * @property {Number} price, default value: `0.00`\n * @property {String} shopId required, Variant ShopId\n * @property {String} sku optional\n * @property {String} type, default value: `\"variant\"`\n * @property {Boolean} taxable, default value: `true`\n * @property {String} taxCode, default value: `\"0000\"`\n * @property {String} taxDescription optional\n * @property {String} title, Label for customers, default value: `\"\"`\n * @property {String} optionTitle, Option internal name, default value: `\"Untitled option\"`\n * @property {Metafield[]} metafields optional\n * @property {Date} createdAt optional\n * @property {Date} updatedAt optional\n * @property {Event[]} eventLog optional, Variant Event Log\n * @property {Workflow} workflow optional\n * @property {String} originCountry optional\n */\n\nconst ProductVariant = new SimpleSchema({\n  \"_id\": {\n    type: String,\n    label: \"Variant ID\"\n  },\n  \"ancestors\": {\n    type: Array,\n    defaultValue: []\n  },\n  \"ancestors.$\": {\n    type: String\n  },\n  \"index\": {\n    label: \"Variant position number in list\",\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"isVisible\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"isDeleted\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"barcode\": {\n    label: \"Barcode\",\n    type: String,\n    optional: true,\n\n    custom() {\n      if (Meteor.isClient) {\n        if (this.siblingField(\"type\").value === \"inventory\" && !this.value) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n\n  },\n  \"compareAtPrice\": {\n    label: \"Compare At Price\",\n    type: Number,\n    optional: true,\n    min: 0,\n    defaultValue: 0.00\n  },\n  \"weight\": {\n    label: \"Weight\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0,\n\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value || this.value === 0)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n\n  },\n  \"length\": {\n    label: \"Length\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"width\": {\n    label: \"Width\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"height\": {\n    label: \"Height\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"inventoryManagement\": {\n    type: Boolean,\n    label: \"Inventory Tracking\",\n    optional: true,\n    defaultValue: true,\n\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value || this.value === false)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n\n  },\n  \"inventoryPolicy\": {\n    type: Boolean,\n    label: \"Deny when out of stock\",\n    optional: true,\n    defaultValue: false,\n\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value || this.value === false)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n\n  },\n  \"lowInventoryWarningThreshold\": {\n    type: SimpleSchema.Integer,\n    label: \"Warn at\",\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"inventoryQuantity\": {\n    type: SimpleSchema.Integer,\n    label: \"Quantity\",\n    optional: true,\n    defaultValue: 0,\n\n    custom() {\n      if (Meteor.isClient) {\n        if (this.siblingField(\"type\").value !== \"inventory\") {\n          if (ReactionProduct.checkChildVariants(this.docId) === 0 && !this.value) {\n            return SimpleSchema.ErrorTypes.REQUIRED;\n          }\n        }\n      }\n    }\n\n  },\n  \"minOrderQuantity\": {\n    label: \"Minimum order quantity\",\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"isLowQuantity\": {\n    label: \"Indicates that the product quantity is too low\",\n    type: Boolean,\n    optional: true\n  },\n  \"isSoldOut\": {\n    label: \"Indicates when the product quantity is zero\",\n    type: Boolean,\n    optional: true\n  },\n  \"price\": {\n    label: \"Price\",\n    type: Number,\n    defaultValue: 0.00,\n    min: 0,\n    optional: true\n  },\n  \"shopId\": {\n    type: String,\n    autoValue: shopIdAutoValue,\n    index: 1,\n    label: \"Variant ShopId\"\n  },\n  \"sku\": {\n    label: \"SKU\",\n    type: String,\n    optional: true\n  },\n  \"type\": {\n    label: \"Type\",\n    type: String,\n    defaultValue: \"variant\"\n  },\n  \"taxable\": {\n    label: \"Taxable\",\n    type: Boolean,\n    defaultValue: true,\n    optional: true\n  },\n  \"taxCode\": {\n    label: \"Tax Code\",\n    type: String,\n    defaultValue: \"0000\",\n    optional: true\n  },\n  \"taxDescription\": {\n    type: String,\n    optional: true,\n    label: \"Tax Description\"\n  },\n  \"title\": {\n    label: \"Label\",\n    type: String,\n    defaultValue: \"\"\n  },\n  \"optionTitle\": {\n    label: \"Option\",\n    type: String,\n    optional: true,\n    defaultValue: \"Untitled Option\"\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"createdAt\": {\n    label: \"Created at\",\n    type: Date,\n    optional: true\n  },\n  \"updatedAt\": {\n    label: \"Updated at\",\n    type: Date,\n    optional: true\n  },\n  // TODO: REVIEW - Does this need to exist? Should we use workflow instead?\n  // Should it be called 'history' or something else instead?\n  // Should this go into the Logger instead? Is the logger robust enough for this?\n  \"eventLog\": {\n    label: \"Variant Event Log\",\n    type: Array,\n    optional: true\n  },\n  \"eventLog.$\": {\n    type: Event\n  },\n  \"workflow\": {\n    type: Workflow,\n    optional: true,\n    defaultValue: {}\n  },\n  \"originCountry\": {\n    type: String,\n    optional: true,\n    autoValue: shopDefaultCountry\n  }\n}, {\n  check,\n  tracker: Tracker\n});\nregisterSchema(\"ProductVariant\", ProductVariant);\n/**\n * @name PriceRange\n * @type {SimpleSchema}\n * @memberof schemas\n * @property {String} range, default value: `\"0.00\"`\n * @property {Number} min optional, default value: `0`\n * @property {Number} max optional, default value: `0`\n */\n\nconst PriceRange = new SimpleSchema({\n  range: {\n    type: String,\n    defaultValue: \"0.00\"\n  },\n  min: {\n    type: Number,\n    defaultValue: 0,\n    optional: true\n  },\n  max: {\n    type: Number,\n    defaultValue: 0,\n    optional: true\n  }\n}, {\n  check,\n  tracker: Tracker\n});\nregisterSchema(\"PriceRange\", PriceRange);\n/**\n * @name Product\n * @type {SimpleSchema}\n * @memberof schemas\n * @property {String} _id Product ID\n * @property {String[]} ancestors default value: `[]`\n * @property {String} shopId Product ShopID\n * @property {String} title Product Title\n * @property {String} pageTitle optional\n * @property {String} description optional\n * @property {String} productType optional\n * @property {String} originCountry optional\n * @property {String} type default value: `\"simple\"`\n * @property {String} vendor optional\n * @property {Metafield[]} metafields optional\n * @property {Object} positions ProductPosition\n * @property {PriceRange} price denormalized, object with range string, min and max\n * @property {Boolean} isLowQuantity denormalized, true when at least 1 variant is below `lowInventoryWarningThreshold`\n * @property {Boolean} isSoldOut denormalized, Indicates when all variants `inventoryQuantity` is zero\n * @property {Boolean} isBackorder denormalized, `true` if product not in stock, but customers anyway could order it\n * @property {Boolean} requiresShipping default value: `true`, Require a shipping address\n * @property {ShippingParcel} parcel optional\n * @property {String[]} hashtags optional\n * @property {String} twitterMsg optional\n * @property {String} facebookMsg optional\n * @property {String} googleplusMsg optional\n * @property {String} pinterestMsg optional\n * @property {String} metaDescription optional\n * @property {String} handle optional, slug\n * @property {Boolean} isDeleted, default value: `false`\n * @property {Boolean} isVisible, default value: `false`\n * @property {String} template, default value: `\"productDetailSimple\"`\n * @property {Date} createdAt required\n * @property {Date} updatedAt optional\n * @property {Date} publishedAt optional\n * @property {String} publishedScope optional\n * @property {Workflow} workflow optional\n */\n\nconst Product = new SimpleSchema({\n  \"_id\": {\n    type: String,\n    label: \"Product Id\"\n  },\n  \"ancestors\": {\n    type: Array,\n    defaultValue: []\n  },\n  \"ancestors.$\": {\n    type: String\n  },\n  \"shopId\": {\n    type: String,\n    autoValue: shopIdAutoValue,\n    index: 1,\n    label: \"Product ShopId\"\n  },\n  \"title\": {\n    type: String,\n    defaultValue: \"\",\n    label: \"Product Title\"\n  },\n  \"pageTitle\": {\n    type: String,\n    optional: true\n  },\n  \"description\": {\n    type: String,\n    optional: true\n  },\n  \"productType\": {\n    type: String,\n    optional: true\n  },\n  \"originCountry\": {\n    type: String,\n    optional: true,\n    autoValue: shopDefaultCountry\n  },\n  \"type\": {\n    label: \"Type\",\n    type: String,\n    defaultValue: \"simple\"\n  },\n  \"vendor\": {\n    type: String,\n    optional: true\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"positions\": {\n    type: Object,\n    // ProductPosition\n    blackbox: true,\n    optional: true\n  },\n  \"price\": {\n    label: \"Price\",\n    type: PriceRange\n  },\n  \"isLowQuantity\": {\n    label: \"Indicates that the product quantity is too low\",\n    type: Boolean,\n    optional: true\n  },\n  \"isSoldOut\": {\n    label: \"Indicates when the product quantity is zero\",\n    type: Boolean,\n    optional: true\n  },\n  \"isBackorder\": {\n    label: \"Indicates when the seller has allowed the sale of product which\" + \" is not in stock\",\n    type: Boolean,\n    optional: true\n  },\n  \"requiresShipping\": {\n    label: \"Require a shipping address\",\n    type: Boolean,\n    defaultValue: true,\n    optional: true\n  },\n  \"parcel\": {\n    type: ShippingParcel,\n    optional: true\n  },\n  \"hashtags\": {\n    type: Array,\n    optional: true,\n    index: 1\n  },\n  \"hashtags.$\": {\n    type: String\n  },\n  \"twitterMsg\": {\n    type: String,\n    optional: true,\n    max: 140\n  },\n  \"facebookMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"googleplusMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"pinterestMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"metaDescription\": {\n    type: String,\n    optional: true\n  },\n  \"handle\": {\n    type: String,\n    optional: true,\n    index: 1,\n\n    autoValue() {\n      let slug = getSlug(this.value);\n\n      if (!slug && this.siblingField(\"title\").value) {\n        slug = getSlug(this.siblingField(\"title\").value);\n      } else if (!slug) {\n        slug = this.siblingField(\"_id\").value || Random.id();\n      }\n\n      if (this.isInsert) {\n        return slug;\n      } else if (this.isUpsert) {\n        return {\n          $setOnInsert: slug\n        };\n      }\n    }\n\n  },\n  \"changedHandleWas\": {\n    type: String,\n    optional: true\n  },\n  \"isDeleted\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"isVisible\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"template\": {\n    label: \"Template\",\n    type: String,\n    defaultValue: \"productDetailSimple\"\n  },\n  \"createdAt\": {\n    type: Date,\n    autoValue: createdAtAutoValue\n  },\n  \"updatedAt\": {\n    type: Date,\n    autoValue: updatedAtAutoValue,\n    optional: true\n  },\n  \"publishedAt\": {\n    type: Date,\n    optional: true\n  },\n  \"publishedScope\": {\n    type: String,\n    optional: true\n  },\n  \"workflow\": {\n    type: Workflow,\n    optional: true,\n    defaultValue: {}\n  }\n}, {\n  check,\n  tracker: Tracker\n});\nregisterSchema(\"Product\", Product);","map":{"version":3,"sources":["lib/collections/schemas/products.js"],"names":["module","export","VariantMedia","ProductPosition","ProductVariant","PriceRange","Product","SimpleSchema","watch","require","default","v","check","Meteor","Random","Tracker","registerSchema","ReactionProduct","getSlug","createdAtAutoValue","shopIdAutoValue","shopDefaultCountry","updatedAtAutoValue","Event","Metafield","ShippingParcel","Workflow","type","String","optional","Integer","Array","Date","autoValue","tracker","tag","position","pinned","Boolean","weight","defaultValue","min","max","updatedAt","label","index","custom","isClient","siblingField","value","ErrorTypes","REQUIRED","Number","checkChildVariants","docId","range","Object","blackbox","slug","id","isInsert","isUpsert","$setOnInsert"],"mappings":"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","sourcesContent":["import SimpleSchema from \"simpl-schema\";\nimport { check } from \"meteor/check\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Random } from \"meteor/random\";\nimport { Tracker } from \"meteor/tracker\";\nimport { registerSchema } from \"@reactioncommerce/schemas\";\nimport { ReactionProduct, getSlug } from \"/lib/api\";\nimport { createdAtAutoValue, shopIdAutoValue, shopDefaultCountry, updatedAtAutoValue } from \"./helpers\";\nimport { Event } from \"./event\";\nimport { Metafield } from \"./metafield\";\nimport { ShippingParcel } from \"./shipping\";\nimport { Workflow } from \"./workflow\";\n\n/**\n * @name VariantMedia\n * @memberof schemas\n * @type {SimpleSchema}\n * @property {String} mediaId optional\n * @property {Number} priority optional\n * @property {Metafield[]} metafields optional\n * @property {Date} updatedAt optional\n * @property {Date} createdAt required\n */\nexport const VariantMedia = new SimpleSchema({\n  \"mediaId\": {\n    type: String,\n    optional: true\n  },\n  \"priority\": {\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"updatedAt\": {\n    type: Date,\n    optional: true\n  },\n  \"createdAt\": {\n    type: Date,\n    autoValue: createdAtAutoValue\n  }\n}, { check, tracker: Tracker });\n\nregisterSchema(\"VariantMedia\", VariantMedia);\n\n/**\n * @name ProductPosition\n * @memberof schemas\n * @type {SimpleSchema}\n * @property {String} tag optional\n * @property {Number} position optional\n * @property {Boolean} pinned optional\n * @property {Number} weight optional, default value: `0`\n * @property {Date} updatedAt required\n */\nexport const ProductPosition = new SimpleSchema({\n  tag: {\n    type: String,\n    optional: true\n  },\n  position: {\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  pinned: {\n    type: Boolean,\n    optional: true\n  },\n  weight: {\n    type: SimpleSchema.Integer,\n    optional: true,\n    defaultValue: 0,\n    min: 0,\n    max: 3\n  },\n  updatedAt: {\n    type: Date\n  }\n}, { check, tracker: Tracker });\n\nregisterSchema(\"ProductPosition\", ProductPosition);\n\n/**\n * @name ProductVariant\n * @memberof schemas\n * @type {SimpleSchema}\n * @property {String} _id required, Variant ID\n * @property {String[]} ancestors, default value: `[]`\n * @property {Number} index optional, Variant position number in list. Keep array index for moving variants in a list.\n * @property {Boolean} isVisible, default value: `false`\n * @property {Boolean} isDeleted, default value: `false`\n * @property {String} barcode optional\n * @property {Number} compareAtPrice optional, Compare at price\n * @property {String} fulfillmentService optional, Fullfillment service\n * @property {Number} weight, default value: `0`\n * @property {Number} length optional, default value: `0`\n * @property {Number} width optional, default value: `0`\n * @property {Number} height optional, default value: `0`\n * @property {Boolean} inventoryManagement, default value: `true`\n * @property {Boolean} inventoryPolicy, default value: `false`, If disabled, item can be sold even if it not in stock.\n * @property {Number} lowInventoryWarningThreshold, default value: `0`, Warn of low inventory at this number\n * @property {Number} inventoryQuantity, default value: `0`\n * @property {Number} minOrderQuantity optional\n * @property {Boolean} isLowQuantity optional, true when at least 1 variant is below `lowInventoryWarningThreshold`\n * @property {Boolean} isSoldOut optional, denormalized field, indicates when all variants `inventoryQuantity` is 0\n * @property {Number} price, default value: `0.00`\n * @property {String} shopId required, Variant ShopId\n * @property {String} sku optional\n * @property {String} type, default value: `\"variant\"`\n * @property {Boolean} taxable, default value: `true`\n * @property {String} taxCode, default value: `\"0000\"`\n * @property {String} taxDescription optional\n * @property {String} title, Label for customers, default value: `\"\"`\n * @property {String} optionTitle, Option internal name, default value: `\"Untitled option\"`\n * @property {Metafield[]} metafields optional\n * @property {Date} createdAt optional\n * @property {Date} updatedAt optional\n * @property {Event[]} eventLog optional, Variant Event Log\n * @property {Workflow} workflow optional\n * @property {String} originCountry optional\n */\nexport const ProductVariant = new SimpleSchema({\n  \"_id\": {\n    type: String,\n    label: \"Variant ID\"\n  },\n  \"ancestors\": {\n    type: Array,\n    defaultValue: []\n  },\n  \"ancestors.$\": {\n    type: String\n  },\n  \"index\": {\n    label: \"Variant position number in list\",\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"isVisible\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"isDeleted\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"barcode\": {\n    label: \"Barcode\",\n    type: String,\n    optional: true,\n    custom() {\n      if (Meteor.isClient) {\n        if (this.siblingField(\"type\").value === \"inventory\" && !this.value) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n  },\n  \"compareAtPrice\": {\n    label: \"Compare At Price\",\n    type: Number,\n    optional: true,\n    min: 0,\n    defaultValue: 0.00\n  },\n  \"weight\": {\n    label: \"Weight\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0,\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value ||\n          this.value === 0)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n  },\n  \"length\": {\n    label: \"Length\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"width\": {\n    label: \"Width\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"height\": {\n    label: \"Height\",\n    type: Number,\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"inventoryManagement\": {\n    type: Boolean,\n    label: \"Inventory Tracking\",\n    optional: true,\n    defaultValue: true,\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value ||\n          this.value === false)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n  },\n  \"inventoryPolicy\": {\n    type: Boolean,\n    label: \"Deny when out of stock\",\n    optional: true,\n    defaultValue: false,\n    custom() {\n      if (Meteor.isClient) {\n        if (!(this.siblingField(\"type\").value === \"inventory\" || this.value ||\n          this.value === false)) {\n          return SimpleSchema.ErrorTypes.REQUIRED;\n        }\n      }\n    }\n  },\n  \"lowInventoryWarningThreshold\": {\n    type: SimpleSchema.Integer,\n    label: \"Warn at\",\n    min: 0,\n    optional: true,\n    defaultValue: 0\n  },\n  \"inventoryQuantity\": {\n    type: SimpleSchema.Integer,\n    label: \"Quantity\",\n    optional: true,\n    defaultValue: 0,\n    custom() {\n      if (Meteor.isClient) {\n        if (this.siblingField(\"type\").value !== \"inventory\") {\n          if (ReactionProduct.checkChildVariants(this.docId) === 0 && !this.value) {\n            return SimpleSchema.ErrorTypes.REQUIRED;\n          }\n        }\n      }\n    }\n  },\n  \"minOrderQuantity\": {\n    label: \"Minimum order quantity\",\n    type: SimpleSchema.Integer,\n    optional: true\n  },\n  \"isLowQuantity\": {\n    label: \"Indicates that the product quantity is too low\",\n    type: Boolean,\n    optional: true\n  },\n  \"isSoldOut\": {\n    label: \"Indicates when the product quantity is zero\",\n    type: Boolean,\n    optional: true\n  },\n  \"price\": {\n    label: \"Price\",\n    type: Number,\n    defaultValue: 0.00,\n    min: 0,\n    optional: true\n  },\n  \"shopId\": {\n    type: String,\n    autoValue: shopIdAutoValue,\n    index: 1,\n    label: \"Variant ShopId\"\n  },\n  \"sku\": {\n    label: \"SKU\",\n    type: String,\n    optional: true\n  },\n  \"type\": {\n    label: \"Type\",\n    type: String,\n    defaultValue: \"variant\"\n  },\n  \"taxable\": {\n    label: \"Taxable\",\n    type: Boolean,\n    defaultValue: true,\n    optional: true\n  },\n  \"taxCode\": {\n    label: \"Tax Code\",\n    type: String,\n    defaultValue: \"0000\",\n    optional: true\n  },\n  \"taxDescription\": {\n    type: String,\n    optional: true,\n    label: \"Tax Description\"\n  },\n  \"title\": {\n    label: \"Label\",\n    type: String,\n    defaultValue: \"\"\n  },\n  \"optionTitle\": {\n    label: \"Option\",\n    type: String,\n    optional: true,\n    defaultValue: \"Untitled Option\"\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"createdAt\": {\n    label: \"Created at\",\n    type: Date,\n    optional: true\n  },\n  \"updatedAt\": {\n    label: \"Updated at\",\n    type: Date,\n    optional: true\n  },\n  // TODO: REVIEW - Does this need to exist? Should we use workflow instead?\n  // Should it be called 'history' or something else instead?\n  // Should this go into the Logger instead? Is the logger robust enough for this?\n  \"eventLog\": {\n    label: \"Variant Event Log\",\n    type: Array,\n    optional: true\n  },\n  \"eventLog.$\": {\n    type: Event\n  },\n  \"workflow\": {\n    type: Workflow,\n    optional: true,\n    defaultValue: {}\n  },\n  \"originCountry\": {\n    type: String,\n    optional: true,\n    autoValue: shopDefaultCountry\n  }\n}, { check, tracker: Tracker });\n\nregisterSchema(\"ProductVariant\", ProductVariant);\n\n/**\n * @name PriceRange\n * @type {SimpleSchema}\n * @memberof schemas\n * @property {String} range, default value: `\"0.00\"`\n * @property {Number} min optional, default value: `0`\n * @property {Number} max optional, default value: `0`\n */\nexport const PriceRange = new SimpleSchema({\n  range: {\n    type: String,\n    defaultValue: \"0.00\"\n  },\n  min: {\n    type: Number,\n    defaultValue: 0,\n    optional: true\n  },\n  max: {\n    type: Number,\n    defaultValue: 0,\n    optional: true\n  }\n}, { check, tracker: Tracker });\n\nregisterSchema(\"PriceRange\", PriceRange);\n\n/**\n * @name Product\n * @type {SimpleSchema}\n * @memberof schemas\n * @property {String} _id Product ID\n * @property {String[]} ancestors default value: `[]`\n * @property {String} shopId Product ShopID\n * @property {String} title Product Title\n * @property {String} pageTitle optional\n * @property {String} description optional\n * @property {String} productType optional\n * @property {String} originCountry optional\n * @property {String} type default value: `\"simple\"`\n * @property {String} vendor optional\n * @property {Metafield[]} metafields optional\n * @property {Object} positions ProductPosition\n * @property {PriceRange} price denormalized, object with range string, min and max\n * @property {Boolean} isLowQuantity denormalized, true when at least 1 variant is below `lowInventoryWarningThreshold`\n * @property {Boolean} isSoldOut denormalized, Indicates when all variants `inventoryQuantity` is zero\n * @property {Boolean} isBackorder denormalized, `true` if product not in stock, but customers anyway could order it\n * @property {Boolean} requiresShipping default value: `true`, Require a shipping address\n * @property {ShippingParcel} parcel optional\n * @property {String[]} hashtags optional\n * @property {String} twitterMsg optional\n * @property {String} facebookMsg optional\n * @property {String} googleplusMsg optional\n * @property {String} pinterestMsg optional\n * @property {String} metaDescription optional\n * @property {String} handle optional, slug\n * @property {Boolean} isDeleted, default value: `false`\n * @property {Boolean} isVisible, default value: `false`\n * @property {String} template, default value: `\"productDetailSimple\"`\n * @property {Date} createdAt required\n * @property {Date} updatedAt optional\n * @property {Date} publishedAt optional\n * @property {String} publishedScope optional\n * @property {Workflow} workflow optional\n */\nexport const Product = new SimpleSchema({\n  \"_id\": {\n    type: String,\n    label: \"Product Id\"\n  },\n  \"ancestors\": {\n    type: Array,\n    defaultValue: []\n  },\n  \"ancestors.$\": {\n    type: String\n  },\n  \"shopId\": {\n    type: String,\n    autoValue: shopIdAutoValue,\n    index: 1,\n    label: \"Product ShopId\"\n  },\n  \"title\": {\n    type: String,\n    defaultValue: \"\",\n    label: \"Product Title\"\n  },\n  \"pageTitle\": {\n    type: String,\n    optional: true\n  },\n  \"description\": {\n    type: String,\n    optional: true\n  },\n  \"productType\": {\n    type: String,\n    optional: true\n  },\n  \"originCountry\": {\n    type: String,\n    optional: true,\n    autoValue: shopDefaultCountry\n  },\n  \"type\": {\n    label: \"Type\",\n    type: String,\n    defaultValue: \"simple\"\n  },\n  \"vendor\": {\n    type: String,\n    optional: true\n  },\n  \"metafields\": {\n    type: Array,\n    optional: true\n  },\n  \"metafields.$\": {\n    type: Metafield\n  },\n  \"positions\": {\n    type: Object, // ProductPosition\n    blackbox: true,\n    optional: true\n  },\n  \"price\": {\n    label: \"Price\",\n    type: PriceRange\n  },\n  \"isLowQuantity\": {\n    label: \"Indicates that the product quantity is too low\",\n    type: Boolean,\n    optional: true\n  },\n  \"isSoldOut\": {\n    label: \"Indicates when the product quantity is zero\",\n    type: Boolean,\n    optional: true\n  },\n  \"isBackorder\": {\n    label: \"Indicates when the seller has allowed the sale of product which\" +\n    \" is not in stock\",\n    type: Boolean,\n    optional: true\n  },\n  \"requiresShipping\": {\n    label: \"Require a shipping address\",\n    type: Boolean,\n    defaultValue: true,\n    optional: true\n  },\n  \"parcel\": {\n    type: ShippingParcel,\n    optional: true\n  },\n  \"hashtags\": {\n    type: Array,\n    optional: true,\n    index: 1\n  },\n  \"hashtags.$\": {\n    type: String\n  },\n  \"twitterMsg\": {\n    type: String,\n    optional: true,\n    max: 140\n  },\n  \"facebookMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"googleplusMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"pinterestMsg\": {\n    type: String,\n    optional: true,\n    max: 255\n  },\n  \"metaDescription\": {\n    type: String,\n    optional: true\n  },\n  \"handle\": {\n    type: String,\n    optional: true,\n    index: 1,\n    autoValue() {\n      let slug = getSlug(this.value);\n\n      if (!slug && this.siblingField(\"title\").value) {\n        slug = getSlug(this.siblingField(\"title\").value);\n      } else if (!slug) {\n        slug = this.siblingField(\"_id\").value || Random.id();\n      }\n      if (this.isInsert) {\n        return slug;\n      } else if (this.isUpsert) {\n        return {\n          $setOnInsert: slug\n        };\n      }\n    }\n  },\n  \"changedHandleWas\": {\n    type: String,\n    optional: true\n  },\n  \"isDeleted\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"isVisible\": {\n    type: Boolean,\n    index: 1,\n    defaultValue: false\n  },\n  \"template\": {\n    label: \"Template\",\n    type: String,\n    defaultValue: \"productDetailSimple\"\n  },\n  \"createdAt\": {\n    type: Date,\n    autoValue: createdAtAutoValue\n  },\n  \"updatedAt\": {\n    type: Date,\n    autoValue: updatedAtAutoValue,\n    optional: true\n  },\n  \"publishedAt\": {\n    type: Date,\n    optional: true\n  },\n  \"publishedScope\": {\n    type: String,\n    optional: true\n  },\n  \"workflow\": {\n    type: Workflow,\n    optional: true,\n    defaultValue: {}\n  }\n}, { check, tracker: Tracker });\n\nregisterSchema(\"Product\", Product);\n"]},"sourceType":"script","hash":"41259808174cabee55e75edd78bfe3d7422d7e15"}
