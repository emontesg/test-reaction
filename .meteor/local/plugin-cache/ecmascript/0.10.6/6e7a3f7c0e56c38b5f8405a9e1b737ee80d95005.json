{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/accounts/client/containers/loginInline.js","filename":"imports/plugins/core/accounts/client/containers/loginInline.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/accounts/client/containers/loginInline.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/accounts/client/containers/loginInline.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/accounts/client/containers/loginInline.js"}},"code":"var _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 0);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 1);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 2);\nvar Reaction, i18next;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  },\n  i18next: function (v) {\n    i18next = v;\n  }\n}, 3);\nvar registerComponent, composeWithTracker;\nmodule.watch(require(\"../../../components/lib\"), {\n  registerComponent: function (v) {\n    registerComponent = v;\n  },\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 4);\nvar LoginInline;\nmodule.watch(require(\"../components/loginInline\"), {\n  \"default\": function (v) {\n    LoginInline = v;\n  }\n}, 5);\nvar Cart;\nmodule.watch(require(\"../../../../../../lib/collections\"), {\n  Cart: function (v) {\n    Cart = v;\n  }\n}, 6);\n\nvar LoginInlineContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inheritsLoose2.default)(LoginInlineContainer, _Component);\n\n  function LoginInlineContainer(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.pushCartWorkflow = function () {\n      Meteor.call(\"workflow/pushCartWorkflow\", \"coreCartWorkflow\", \"checkoutLogin\", function (error) {\n        if (error) {\n          // Do not bother to try to advance workflow if we can't go beyond login.\n          return;\n        }\n\n        var cart = Cart.findOne({\n          userId: Meteor.userId()\n        }); // If there's already a billing and shipping address selected, push beyond address book\n\n        if (cart && cart.billing[0] && cart.billing[0].address && cart.shipping[0] && cart.shipping[0].address) {\n          Meteor.call(\"workflow/pushCartWorkflow\", \"coreCartWorkflow\", \"checkoutAddressBook\");\n        }\n      });\n    };\n\n    _this.continueAsGuest = function (event) {\n      event.preventDefault();\n\n      if (_this.state.isStripeEnabled) {\n        _this.setState({\n          renderEmailForm: true\n        });\n      } else {\n        _this.pushCartWorkflow();\n      }\n    };\n\n    _this.handleEmailSubmit = function (event, email) {\n      event.preventDefault();\n      var userId = Meteor.userId();\n      Meteor.call(\"cart/setAnonymousUserEmail\", userId, email, function (error) {\n        if (error) {\n          Alerts.toast(i18next.t(\"mail.alerts.addCartEmailFailed\"), \"error\");\n        } else {\n          _this.pushCartWorkflow();\n        }\n      });\n    };\n\n    _this.state = {\n      isStripeEnabled: props.isStripeEnabled,\n      renderEmailForm: false\n    };\n    return _this;\n  }\n\n  var _proto = LoginInlineContainer.prototype;\n\n  _proto.componentWillReceiveProps = function () {\n    function componentWillReceiveProps(nextProps) {\n      this.setState({\n        isStripeEnabled: nextProps.isStripeEnabled\n      });\n    }\n\n    return componentWillReceiveProps;\n  }();\n\n  _proto.render = function () {\n    function render() {\n      return React.createElement(LoginInline, {\n        continueAsGuest: this.continueAsGuest,\n        renderEmailForm: this.state.renderEmailForm,\n        handleEmailSubmit: this.handleEmailSubmit\n      });\n    }\n\n    return render;\n  }();\n\n  return LoginInlineContainer;\n}(Component);\n\nLoginInlineContainer.propTypes = {\n  isStripeEnabled: PropTypes.bool\n};\n\nfunction composer(props, onData) {\n  var isStripeEnabled = false;\n  var subscription = Reaction.Subscriptions.Packages;\n  var primaryShopId = Reaction.getPrimaryShopId();\n  var stripePkg = Reaction.getPackageSettingsWithOptions({\n    shopId: primaryShopId,\n    name: \"reaction-stripe\",\n    enabled: true\n  });\n\n  if (subscription.ready()) {\n    if (stripePkg) {\n      isStripeEnabled = true;\n    }\n\n    onData(null, {\n      isStripeEnabled: isStripeEnabled\n    });\n  }\n}\n\nregisterComponent(\"LoginInline\", LoginInlineContainer, composeWithTracker(composer));\nmodule.exportDefault(composeWithTracker(composer)(LoginInlineContainer));","map":{"version":3,"sources":["imports/plugins/core/accounts/client/containers/loginInline.js"],"names":["React","Component","module","watch","require","v","PropTypes","Meteor","Reaction","i18next","registerComponent","composeWithTracker","LoginInline","Cart","LoginInlineContainer","props","pushCartWorkflow","call","error","cart","findOne","userId","billing","address","shipping","continueAsGuest","event","preventDefault","state","isStripeEnabled","setState","renderEmailForm","handleEmailSubmit","email","Alerts","toast","t","componentWillReceiveProps","nextProps","render","propTypes","bool","composer","onData","subscription","Subscriptions","Packages","primaryShopId","getPrimaryShopId","stripePkg","getPackageSettingsWithOptions","shopId","name","enabled","ready","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { registerComponent, composeWithTracker } from \"@reactioncommerce/reaction-components\";\nimport LoginInline from \"../components/loginInline\";\nimport { Cart } from \"/lib/collections\";\n\nclass LoginInlineContainer extends Component {\n  static propTypes = {\n    isStripeEnabled: PropTypes.bool\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isStripeEnabled: props.isStripeEnabled,\n      renderEmailForm: false\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({\n      isStripeEnabled: nextProps.isStripeEnabled\n    });\n  }\n\n  pushCartWorkflow = () => {\n    Meteor.call(\"workflow/pushCartWorkflow\", \"coreCartWorkflow\", \"checkoutLogin\", (error) => {\n      if (error) {\n        // Do not bother to try to advance workflow if we can't go beyond login.\n        return;\n      }\n      const cart = Cart.findOne({\n        userId: Meteor.userId()\n      });\n      // If there's already a billing and shipping address selected, push beyond address book\n      if (cart && cart.billing[0] && cart.billing[0].address\n        && cart.shipping[0] && cart.shipping[0].address) {\n        Meteor.call(\"workflow/pushCartWorkflow\", \"coreCartWorkflow\", \"checkoutAddressBook\");\n      }\n    });\n  }\n\n  continueAsGuest = (event) => {\n    event.preventDefault();\n    if (this.state.isStripeEnabled) {\n      this.setState({\n        renderEmailForm: true\n      });\n    } else {\n      this.pushCartWorkflow();\n    }\n  }\n\n  /**\n   * @method handleEmailSubmit\n   * @summary Handle submitting the email form\n   * @param {Event} event - the event that fired\n   * @param {String} email - anonymous user's email\n   * @return {undefined} undefined\n   */\n  handleEmailSubmit = (event, email) => {\n    event.preventDefault();\n    const userId = Meteor.userId();\n    Meteor.call(\"cart/setAnonymousUserEmail\", userId, email, (error) => {\n      if (error) {\n        Alerts.toast(i18next.t(\"mail.alerts.addCartEmailFailed\"), \"error\");\n      } else {\n        this.pushCartWorkflow();\n      }\n    });\n  }\n\n  render() {\n    return (\n      <LoginInline\n        continueAsGuest={this.continueAsGuest}\n        renderEmailForm={this.state.renderEmailForm}\n        handleEmailSubmit={this.handleEmailSubmit}\n      />\n    );\n  }\n}\n\nfunction composer(props, onData) {\n  let isStripeEnabled = false;\n  const subscription = Reaction.Subscriptions.Packages;\n  const primaryShopId = Reaction.getPrimaryShopId();\n\n  const stripePkg = Reaction.getPackageSettingsWithOptions({\n    shopId: primaryShopId,\n    name: \"reaction-stripe\",\n    enabled: true\n  });\n\n  if (subscription.ready()) {\n    if (stripePkg) {\n      isStripeEnabled = true;\n    }\n\n    onData(null, {\n      isStripeEnabled\n    });\n  }\n}\n\nregisterComponent(\"LoginInline\", LoginInlineContainer, composeWithTracker(composer));\n\nexport default composeWithTracker(composer)(LoginInlineContainer);\n"]},"sourceType":"script","hash":"6e7a3f7c0e56c38b5f8405a9e1b737ee80d95005"}
