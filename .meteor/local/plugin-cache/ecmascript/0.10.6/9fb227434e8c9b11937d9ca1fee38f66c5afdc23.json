{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/included/product-variant/containers/productGridItemsContainer.js","filename":"imports/plugins/included/product-variant/containers/productGridItemsContainer.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/included/product-variant/containers/productGridItemsContainer.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/included/product-variant/containers/productGridItemsContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/included/product-variant/containers/productGridItemsContainer.js"}},"code":"var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _compose;\n\nmodule.watch(require(\"recompose/compose\"), {\n  \"default\": function (v) {\n    _compose = v;\n  }\n}, 0);\n\nvar _max;\n\nmodule.watch(require(\"lodash/max\"), {\n  \"default\": function (v) {\n    _max = v;\n  }\n}, 1);\n\nvar _min;\n\nmodule.watch(require(\"lodash/min\"), {\n  \"default\": function (v) {\n    _min = v;\n  }\n}, 2);\n\nvar _includes;\n\nmodule.watch(require(\"lodash/includes\"), {\n  \"default\": function (v) {\n    _includes = v;\n  }\n}, 3);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 4);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 5);\nvar registerComponent;\nmodule.watch(require(\"../../../core/components/lib\"), {\n  registerComponent: function (v) {\n    registerComponent = v;\n  }\n}, 6);\nvar Session;\nmodule.watch(require(\"meteor/session\"), {\n  Session: function (v) {\n    Session = v;\n  }\n}, 7);\nvar Reaction;\nmodule.watch(require(\"../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 8);\nvar ReactionProduct;\nmodule.watch(require(\"../../../../../lib/api\"), {\n  ReactionProduct: function (v) {\n    ReactionProduct = v;\n  }\n}, 9);\nvar SortableItem;\nmodule.watch(require(\"../../../core/ui/client/containers\"), {\n  SortableItem: function (v) {\n    SortableItem = v;\n  }\n}, 10);\nvar ProductGridItems;\nmodule.watch(require(\"../components/productGridItems\"), {\n  \"default\": function (v) {\n    ProductGridItems = v;\n  }\n}, 11);\n\nvar wrapComponent = function (Comp) {\n  var _class, _temp2;\n\n  return _temp2 = _class =\n  /*#__PURE__*/\n  function (_Component) {\n    (0, _inheritsLoose2.default)(ProductGridItemsContainer, _Component);\n\n    function ProductGridItemsContainer() {\n      var _temp, _this;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return (_temp = _this = _Component.call.apply(_Component, [this].concat(args)) || this, _this.onPageClick = function (event) {\n        // Do nothing if we are in preview mode\n        if (Reaction.isPreview() === false) {\n          // Don't trigger the clear selection if we're clicking on a grid item.\n          if (event.target.closest(\".product-grid-item\") === null) {\n            var selectedProducts = Session.get(\"productGrid/selectedProducts\"); // Do we have any selected products?\n            // If we do then lets reset the Grid Settings ActionView\n\n            if (Array.isArray(selectedProducts) && selectedProducts.length) {\n              // Reset sessions ver of selected products\n              Session.set(\"productGrid/selectedProducts\", []); // Reset the action view of selected products\n\n              Reaction.setActionView({\n                label: \"Grid Settings\",\n                i18nKeyLabel: \"gridSettingsPanel.title\",\n                template: \"productSettings\",\n                type: \"product\",\n                data: {}\n              });\n            }\n          }\n        }\n      }, _this.productPath = function () {\n        if (_this.props.product) {\n          var handle = _this.props.product.handle;\n\n          if (_this.props.product.__published) {\n            handle = _this.props.product.__published.handle;\n          }\n\n          return Reaction.Router.pathFor(\"product\", {\n            hash: {\n              handle: handle\n            }\n          });\n        }\n\n        return \"/\";\n      }, _this.positions = function () {\n        var tag = ReactionProduct.getTag();\n        return _this.props.product.positions && _this.props.product.positions[tag] || {};\n      }, _this.weightClass = function () {\n        var positions = _this.positions();\n\n        var weight = positions.weight || 0;\n\n        switch (weight) {\n          case 1:\n            return \"product-medium\";\n\n          case 2:\n            return \"product-large\";\n\n          default:\n            return \"product-small\";\n        }\n      }, _this.isSelected = function () {\n        if (Reaction.isPreview() === false) {\n          return _includes(Session.get(\"productGrid/selectedProducts\"), _this.props.product._id) ? \"active\" : \"\";\n        }\n\n        return false;\n      }, _this.isMediumWeight = function () {\n        var positions = _this.positions();\n\n        var weight = positions.weight || 0;\n        return weight === 1;\n      }, _this.displayPrice = function () {\n        if (_this.props.product.price && _this.props.product.price.range) {\n          return _this.props.product.price.range;\n        }\n      }, _this.handleCheckboxSelect = function (list, product) {\n        var checkbox = list.querySelector(\"input[type=checkbox][value=\\\"\" + product._id + \"\\\"]\");\n        var items = document.querySelectorAll(\"li.product-grid-item\");\n        var activeItems = document.querySelectorAll(\"li.product-grid-item.active\");\n        var selected = activeItems.length;\n\n        if (event.shiftKey && selected > 0) {\n          var indexes = [Array.prototype.indexOf.call(items, document.querySelector(\"li.product-grid-item[id=\\\"\" + product._id + \"\\\"]\")), Array.prototype.indexOf.call(items, activeItems[0]), Array.prototype.indexOf.call(items, activeItems[selected - 1])];\n\n          for (var i = _min(indexes); i <= _max(indexes); i += 1) {\n            checkbox = items[i].querySelector(\"input[type=checkbox]\");\n\n            if (checkbox.checked === false) {\n              checkbox.checked = true;\n\n              _this.props.itemSelectHandler(checkbox.checked, product._id);\n            }\n          }\n        } else if (checkbox) {\n          checkbox.checked = !checkbox.checked;\n\n          _this.props.itemSelectHandler(checkbox.checked, product._id);\n        }\n      }, _this.onDoubleClick = function () {\n        var product = _this.props.product;\n        var handle = product.__published && product.__published.handle || product.handle;\n        Reaction.Router.go(\"product\", {\n          handle: handle\n        }); // Open actionView to productDetails panel\n\n        Reaction.state.set(\"edit/focus\", \"productDetails\");\n        Reaction.setActionView({\n          i18nKeyLabel: \"productDetailEdit.productSettings\",\n          label: \"Product Settings\",\n          template: \"ProductAdmin\"\n        });\n\n        if (_this.props.isSearch) {\n          _this.props.unmountMe();\n        }\n      }, _this.onClick = function (event) {\n        event.preventDefault();\n        var product = _this.props.product;\n\n        if (Reaction.hasPermission(\"createProduct\") && Reaction.isPreview() === false) {\n          if (_this.props.isSearch) {\n            var handle = product.handle;\n\n            if (product.__published) {\n              handle = product.__published.handle;\n            }\n\n            Reaction.Router.go(\"product\", {\n              handle: handle\n            });\n\n            _this.props.unmountMe();\n          }\n\n          var isSelected = event.target.closest(\"li.product-grid-item.active\");\n          var list = document.getElementById(\"product-grid-list\");\n\n          if (isSelected) {\n            // If a product is already selected, and you are single clicking on another product(s)\n            // WITH command key, the product(s) are added to the selected products Session array\n            _this.handleCheckboxSelect(list, product);\n\n            if (event.metaKey || event.ctrlKey || event.shiftKey) {\n              _this.handleCheckboxSelect(list, product);\n            }\n          } else if (event.metaKey || event.ctrlKey || event.shiftKey) {\n            _this.handleCheckboxSelect(list, product);\n          } else {\n            var checkbox = list.querySelector(\"input[type=checkbox][value=\\\"\" + product._id + \"\\\"]\");\n            Session.set(\"productGrid/selectedProducts\", []);\n\n            if (checkbox) {\n              checkbox.checked = true;\n\n              _this.props.itemSelectHandler(checkbox.checked, product._id);\n            }\n          }\n        } else {\n          var _handle = product.__published && product.__published.handle || product.handle;\n\n          Reaction.Router.go(\"product\", {\n            handle: _handle\n          });\n\n          if (_this.props.isSearch) {\n            _this.props.unmountMe();\n          }\n        }\n      }, _temp) || (0, _assertThisInitialized2.default)(_this);\n    }\n\n    var _proto = ProductGridItemsContainer.prototype;\n\n    _proto.componentDidMount = function () {\n      function componentDidMount() {\n        document.querySelector(\".page > main\").addEventListener(\"click\", this.onPageClick);\n      }\n\n      return componentDidMount;\n    }();\n\n    _proto.componentWillUnmount = function () {\n      function componentWillUnmount() {\n        document.querySelector(\".page > main\").removeEventListener(\"click\", this.onPageClick);\n      }\n\n      return componentWillUnmount;\n    }();\n\n    _proto.render = function () {\n      function render() {\n        return React.createElement(Comp, (0, _extends2.default)({\n          product: this.props.product,\n          pdpPath: this.productPath,\n          positions: this.positions,\n          weightClass: this.weightClass,\n          isSelected: this.isSelected,\n          isMediumWeight: this.isMediumWeight,\n          displayPrice: this.displayPrice,\n          onDoubleClick: this.onDoubleClick,\n          onClick: this.onClick\n        }, this.props));\n      }\n\n      return render;\n    }();\n\n    return ProductGridItemsContainer;\n  }(Component), _class.propTypes = {\n    connectDragSource: PropTypes.func,\n    connectDropTarget: PropTypes.func,\n    isSearch: PropTypes.bool,\n    itemSelectHandler: PropTypes.func,\n    product: PropTypes.object,\n    unmountMe: PropTypes.func\n  }, _temp2;\n};\n\nregisterComponent(\"ProductGridItems\", ProductGridItems, [SortableItem(\"productGridItem\"), wrapComponent]);\nmodule.exportDefault(_compose(SortableItem(\"productGridItem\"), wrapComponent)(ProductGridItems));","map":{"version":3,"sources":["imports/plugins/included/product-variant/containers/productGridItemsContainer.js"],"names":["_compose","module","watch","require","v","_max","_min","_includes","React","Component","PropTypes","registerComponent","Session","Reaction","ReactionProduct","SortableItem","ProductGridItems","wrapComponent","Comp","onPageClick","event","isPreview","target","closest","selectedProducts","get","Array","isArray","length","set","setActionView","label","i18nKeyLabel","template","type","data","productPath","props","product","handle","__published","Router","pathFor","hash","positions","tag","getTag","weightClass","weight","isSelected","_id","isMediumWeight","displayPrice","price","range","handleCheckboxSelect","list","checkbox","querySelector","items","document","querySelectorAll","activeItems","selected","shiftKey","indexes","prototype","indexOf","call","i","checked","itemSelectHandler","onDoubleClick","go","state","isSearch","unmountMe","onClick","preventDefault","hasPermission","getElementById","metaKey","ctrlKey","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","render","propTypes","connectDragSource","func","connectDropTarget","bool","object","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport _ from \"lodash\";\nimport { compose } from \"recompose\";\nimport { registerComponent } from \"@reactioncommerce/reaction-components\";\nimport { Session } from \"meteor/session\";\nimport { Reaction } from \"/client/api\";\nimport { ReactionProduct } from \"/lib/api\";\nimport { SortableItem } from \"/imports/plugins/core/ui/client/containers\";\nimport ProductGridItems from \"../components/productGridItems\";\n\nconst wrapComponent = (Comp) => (\n  class ProductGridItemsContainer extends Component {\n    static propTypes = {\n      connectDragSource: PropTypes.func,\n      connectDropTarget: PropTypes.func,\n      isSearch: PropTypes.bool,\n      itemSelectHandler: PropTypes.func,\n      product: PropTypes.object,\n      unmountMe: PropTypes.func\n    }\n\n    componentDidMount() {\n      document.querySelector(\".page > main\").addEventListener(\"click\", this.onPageClick);\n    }\n\n    componentWillUnmount() {\n      document.querySelector(\".page > main\").removeEventListener(\"click\", this.onPageClick);\n    }\n\n    onPageClick = (event) => {\n      // Do nothing if we are in preview mode\n      if (Reaction.isPreview() === false) {\n        // Don't trigger the clear selection if we're clicking on a grid item.\n        if (event.target.closest(\".product-grid-item\") === null) {\n          const selectedProducts = Session.get(\"productGrid/selectedProducts\");\n\n          // Do we have any selected products?\n          // If we do then lets reset the Grid Settings ActionView\n          if (Array.isArray(selectedProducts) && selectedProducts.length) {\n            // Reset sessions ver of selected products\n            Session.set(\"productGrid/selectedProducts\", []);\n\n            // Reset the action view of selected products\n            Reaction.setActionView({\n              label: \"Grid Settings\",\n              i18nKeyLabel: \"gridSettingsPanel.title\",\n              template: \"productSettings\",\n              type: \"product\",\n              data: {}\n            });\n          }\n        }\n      }\n    }\n\n    productPath = () => {\n      if (this.props.product) {\n        let { handle } = this.props.product;\n\n        if (this.props.product.__published) {\n          ({ handle } = this.props.product.__published);\n        }\n\n        return Reaction.Router.pathFor(\"product\", {\n          hash: {\n            handle\n          }\n        });\n      }\n\n      return \"/\";\n    }\n\n    positions = () => {\n      const tag = ReactionProduct.getTag();\n      return (this.props.product.positions && this.props.product.positions[tag]) || {};\n    }\n\n    weightClass = () => {\n      const positions = this.positions();\n      const weight = positions.weight || 0;\n      switch (weight) {\n        case 1:\n          return \"product-medium\";\n        case 2:\n          return \"product-large\";\n        default:\n          return \"product-small\";\n      }\n    }\n\n    isSelected = () => {\n      if (Reaction.isPreview() === false) {\n        return _.includes(Session.get(\"productGrid/selectedProducts\"), this.props.product._id) ? \"active\" : \"\";\n      }\n      return false;\n    }\n\n    isMediumWeight = () => {\n      const positions = this.positions();\n      const weight = positions.weight || 0;\n\n      return weight === 1;\n    }\n\n    displayPrice = () => {\n      if (this.props.product.price && this.props.product.price.range) {\n        return this.props.product.price.range;\n      }\n    }\n\n    handleCheckboxSelect = (list, product) => {\n      let checkbox = list.querySelector(`input[type=checkbox][value=\"${product._id}\"]`);\n      const items = document.querySelectorAll(\"li.product-grid-item\");\n      const activeItems = document.querySelectorAll(\"li.product-grid-item.active\");\n      const selected = activeItems.length;\n\n      if (event.shiftKey && selected > 0) {\n        const indexes = [\n          Array.prototype.indexOf.call(items, document.querySelector(`li.product-grid-item[id=\"${product._id}\"]`)),\n          Array.prototype.indexOf.call(items, activeItems[0]),\n          Array.prototype.indexOf.call(items, activeItems[selected - 1])\n        ];\n        for (let i = _.min(indexes); i <= _.max(indexes); i += 1) {\n          checkbox = items[i].querySelector(\"input[type=checkbox]\");\n          if (checkbox.checked === false) {\n            checkbox.checked = true;\n            this.props.itemSelectHandler(checkbox.checked, product._id);\n          }\n        }\n      } else if (checkbox) {\n        checkbox.checked = !checkbox.checked;\n        this.props.itemSelectHandler(checkbox.checked, product._id);\n      }\n    }\n\n    onDoubleClick = () => {\n      const { product } = this.props;\n      const handle = (product.__published && product.__published.handle) || product.handle;\n\n      Reaction.Router.go(\"product\", {\n        handle\n      });\n\n      // Open actionView to productDetails panel\n      Reaction.state.set(\"edit/focus\", \"productDetails\");\n\n      Reaction.setActionView({\n        i18nKeyLabel: \"productDetailEdit.productSettings\",\n        label: \"Product Settings\",\n        template: \"ProductAdmin\"\n      });\n\n      if (this.props.isSearch) {\n        this.props.unmountMe();\n      }\n    }\n\n    onClick = (event) => {\n      event.preventDefault();\n      const { product } = this.props;\n\n      if (Reaction.hasPermission(\"createProduct\") && Reaction.isPreview() === false) {\n        if (this.props.isSearch) {\n          let { handle } = product;\n          if (product.__published) {\n            ({ handle } = product.__published);\n          }\n\n          Reaction.Router.go(\"product\", {\n            handle\n          });\n\n          this.props.unmountMe();\n        }\n\n        const isSelected = event.target.closest(\"li.product-grid-item.active\");\n        const list = document.getElementById(\"product-grid-list\");\n\n        if (isSelected) {\n          // If a product is already selected, and you are single clicking on another product(s)\n          // WITH command key, the product(s) are added to the selected products Session array\n          this.handleCheckboxSelect(list, product);\n          if (event.metaKey || event.ctrlKey || event.shiftKey) {\n            this.handleCheckboxSelect(list, product);\n          }\n        } else if (event.metaKey || event.ctrlKey || event.shiftKey) {\n          this.handleCheckboxSelect(list, product);\n        } else {\n          const checkbox = list.querySelector(`input[type=checkbox][value=\"${product._id}\"]`);\n          Session.set(\"productGrid/selectedProducts\", []);\n          if (checkbox) {\n            checkbox.checked = true;\n            this.props.itemSelectHandler(checkbox.checked, product._id);\n          }\n        }\n      } else {\n        const handle = (product.__published && product.__published.handle) || product.handle;\n\n        Reaction.Router.go(\"product\", {\n          handle\n        });\n\n        if (this.props.isSearch) {\n          this.props.unmountMe();\n        }\n      }\n    }\n\n    render() {\n      return (\n        <Comp\n          product={this.props.product}\n          pdpPath={this.productPath}\n          positions={this.positions}\n          weightClass={this.weightClass}\n          isSelected={this.isSelected}\n          isMediumWeight={this.isMediumWeight}\n          displayPrice={this.displayPrice}\n          onDoubleClick={this.onDoubleClick}\n          onClick={this.onClick}\n          {...this.props}\n        />\n      );\n    }\n  }\n);\n\nregisterComponent(\"ProductGridItems\", ProductGridItems, [\n  SortableItem(\"productGridItem\"),\n  wrapComponent\n]);\n\nexport default compose(\n  SortableItem(\"productGridItem\"),\n  wrapComponent\n)(ProductGridItems);\n"]},"sourceType":"script","hash":"9fb227434e8c9b11937d9ca1fee38f66c5afdc23"}
