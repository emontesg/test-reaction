{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/accounts/client/containers/auth.js","filename":"imports/plugins/core/accounts/client/containers/auth.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/accounts/client/containers/auth.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/accounts/client/containers/auth.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/accounts/client/containers/auth.js"}},"code":"var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _filter;\n\nmodule.watch(require(\"lodash/filter\"), {\n  \"default\": function (v) {\n    _filter = v;\n  }\n}, 0);\n\nvar _isEmpty;\n\nmodule.watch(require(\"lodash/isEmpty\"), {\n  \"default\": function (v) {\n    _isEmpty = v;\n  }\n}, 1);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 2);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 3);\nvar Components, registerComponent, composeWithTracker;\nmodule.watch(require(\"../../../components/lib\"), {\n  Components: function (v) {\n    Components = v;\n  },\n  registerComponent: function (v) {\n    registerComponent = v;\n  },\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 4);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 5);\nvar Accounts;\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function (v) {\n    Accounts = v;\n  }\n}, 6);\nvar Router;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Router: function (v) {\n    Router = v;\n  }\n}, 7);\nvar ServiceConfigHelper, LoginFormSharedHelpers;\nmodule.watch(require(\"../helpers\"), {\n  ServiceConfigHelper: function (v) {\n    ServiceConfigHelper = v;\n  },\n  LoginFormSharedHelpers: function (v) {\n    LoginFormSharedHelpers = v;\n  }\n}, 8);\nvar LoginFormValidation;\nmodule.watch(require(\"../../../../../../lib/api\"), {\n  LoginFormValidation: function (v) {\n    LoginFormValidation = v;\n  }\n}, 9);\n\nvar AuthContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inheritsLoose2.default)(AuthContainer, _Component);\n\n  function AuthContainer(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.handleFormSubmit = function (event, email, password) {\n      event.preventDefault();\n\n      _this.setState({\n        isLoading: true\n      });\n\n      var errors = {};\n      var username = email ? email.trim() : null;\n      var pword = password ? password.trim() : null;\n      var validatedEmail = LoginFormValidation.email(username);\n      var validatedPassword = LoginFormValidation.password(pword, {\n        validationLevel: \"exists\"\n      });\n\n      if (validatedEmail !== true) {\n        errors.email = validatedEmail;\n      }\n\n      if (validatedPassword !== true) {\n        errors.password = validatedPassword;\n      }\n\n      if (_isEmpty(errors) === false) {\n        _this.setState({\n          isLoading: false,\n          formMessages: {\n            errors: errors\n          }\n        });\n\n        return;\n      }\n\n      if (_this.props.currentView === \"loginFormSignInView\") {\n        Meteor.loginWithPassword(username, pword, function (error) {\n          if (error) {\n            _this.setState({\n              isLoading: false,\n              formMessages: {\n                alerts: [error]\n              }\n            });\n          } else {\n            Router.go(_this.props.currentRoute.route.path);\n          }\n        });\n      } else if (_this.props.currentView === \"loginFormSignUpView\") {\n        var newUserData = {\n          email: username,\n          password: pword\n        };\n        Accounts.createUser(newUserData, function (error) {\n          if (error) {\n            _this.setState({\n              isLoading: false,\n              formMessages: {\n                alerts: [error]\n              }\n            });\n          } else {\n            Router.go(_this.props.currentRoute.route.path);\n          }\n        });\n      }\n    };\n\n    _this.hasError = function (error) {\n      // True here means the field is valid\n      // We're checking if theres some other message to display\n      if (error !== true && typeof error !== \"undefined\") {\n        return true;\n      }\n\n      return false;\n    };\n\n    _this.formMessages = function () {\n      return React.createElement(Components.LoginFormMessages, {\n        messages: _this.state.formMessages\n      });\n    };\n\n    _this.services = function () {\n      var serviceHelper = new ServiceConfigHelper();\n      return serviceHelper.services();\n    };\n\n    _this.shouldShowSeperator = function () {\n      var serviceHelper = new ServiceConfigHelper();\n      var services = serviceHelper.services();\n\n      var enabledServices = _filter(services, {\n        enabled: true\n      });\n\n      return !!Package[\"accounts-password\"] && enabledServices.length > 0;\n    };\n\n    _this.capitalizeName = function (str) {\n      return LoginFormSharedHelpers.capitalize(str);\n    };\n\n    _this.handleSocialLogin = function (value) {\n      var serviceName = value; // Get proper service name\n\n      if (serviceName === \"meteor-developer\") {\n        serviceName = \"MeteorDeveloperAccount\";\n      } else {\n        serviceName = _this.capitalizeName(serviceName);\n      }\n\n      var loginWithService = Meteor[\"loginWith\" + serviceName];\n      var options = {}; // use default scope unless specified\n\n      loginWithService(options, function (error) {\n        if (error) {\n          _this.setState({\n            formMessages: {\n              alerts: [error]\n            }\n          });\n        }\n      });\n    };\n\n    _this.hasPasswordService = function () {\n      return !!Package[\"accounts-password\"];\n    };\n\n    _this.state = {\n      formMessages: props.formMessages || {},\n      isLoading: false\n    };\n    _this.handleFormSubmit = _this.handleFormSubmit.bind((0, _assertThisInitialized2.default)(_this));\n    _this.hasError = _this.hasError.bind((0, _assertThisInitialized2.default)(_this));\n    _this.formMessages = _this.formMessages.bind((0, _assertThisInitialized2.default)(_this));\n    _this.services = _this.services.bind((0, _assertThisInitialized2.default)(_this));\n    _this.shouldShowSeperator = _this.shouldShowSeperator.bind((0, _assertThisInitialized2.default)(_this));\n    _this.handleSocialLogin = _this.handleSocialLogin.bind((0, _assertThisInitialized2.default)(_this));\n    _this.capitalizeName = _this.capitalizeName.bind((0, _assertThisInitialized2.default)(_this));\n    _this.hasPasswordService = _this.hasPasswordService.bind((0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  var _proto = AuthContainer.prototype;\n\n  _proto.renderAuthView = function () {\n    function renderAuthView() {\n      if (this.props.currentView === \"loginFormSignInView\") {\n        return React.createElement(Components.SignIn, (0, _extends2.default)({}, this.props, {\n          onFormSubmit: this.handleFormSubmit,\n          messages: this.state.formMessages,\n          onError: this.hasError,\n          loginFormMessages: this.formMessages,\n          isLoading: this.state.isLoading\n        }));\n      } else if (this.props.currentView === \"loginFormSignUpView\") {\n        return React.createElement(Components.SignUp, (0, _extends2.default)({}, this.props, {\n          onFormSubmit: this.handleFormSubmit,\n          messages: this.state.formMessages,\n          onError: this.hasError,\n          loginFormMessages: this.formMessages,\n          hasPasswordService: this.hasPasswordService,\n          isLoading: this.state.isLoading\n        }));\n      }\n    }\n\n    return renderAuthView;\n  }();\n\n  _proto.render = function () {\n    function render() {\n      return React.createElement(\"div\", null, React.createElement(Components.LoginButtons, {\n        loginServices: this.services,\n        currentView: this.props.currentView,\n        onSeparator: this.shouldShowSeperator,\n        onSocialClick: this.handleSocialLogin,\n        capitalizeName: this.capitalizeName\n      }), this.renderAuthView());\n    }\n\n    return render;\n  }();\n\n  return AuthContainer;\n}(Component);\n\nAuthContainer.propTypes = {\n  currentRoute: PropTypes.object,\n  currentView: PropTypes.string,\n  formMessages: PropTypes.object\n};\n\nfunction composer(props, onData) {\n  onData(null, {\n    currentRoute: Router.current()\n  });\n}\n\nregisterComponent(\"AuthContainer\", AuthContainer, composeWithTracker(composer));\nmodule.exportDefault(composeWithTracker(composer)(AuthContainer));","map":{"version":3,"sources":["imports/plugins/core/accounts/client/containers/auth.js"],"names":["_filter","module","watch","require","v","_isEmpty","React","Component","PropTypes","Components","registerComponent","composeWithTracker","Meteor","Accounts","Router","ServiceConfigHelper","LoginFormSharedHelpers","LoginFormValidation","AuthContainer","props","handleFormSubmit","event","email","password","preventDefault","setState","isLoading","errors","username","trim","pword","validatedEmail","validatedPassword","validationLevel","formMessages","currentView","loginWithPassword","error","alerts","go","currentRoute","route","path","newUserData","createUser","hasError","state","services","serviceHelper","shouldShowSeperator","enabledServices","enabled","Package","length","capitalizeName","str","capitalize","handleSocialLogin","value","serviceName","loginWithService","options","hasPasswordService","bind","renderAuthView","render","propTypes","object","string","composer","onData","current","exportDefault"],"mappings":";;;;;;;;AAAA,IAAIA,OAAJ;;AAAYC,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAAA,uBAASC,CAAT,EAAW;AAACJ,cAAQI,CAAR;AAAU;AAAtB,CAAtC,EAA8D,CAA9D;;AAAiE,IAAIC,QAAJ;;AAAaJ,OAAOC,KAAP,CAAaC,QAAQ,gBAAR,CAAb,EAAuC;AAAA,uBAASC,CAAT,EAAW;AAACC,eAASD,CAAT;AAAW;AAAvB,CAAvC,EAAgE,CAAhE;AAAmE,IAAIE,KAAJ,EAAUC,SAAV;AAAoBN,OAAOC,KAAP,CAAaC,QAAQ,OAAR,CAAb,EAA8B;AAAA,uBAASC,CAAT,EAAW;AAACE,YAAMF,CAAN;AAAQ,GAApB;AAAqBG,WAArB,YAA+BH,CAA/B,EAAiC;AAACG,gBAAUH,CAAV;AAAY;AAA9C,CAA9B,EAA8E,CAA9E;AAAiF,IAAII,SAAJ;AAAcP,OAAOC,KAAP,CAAaC,QAAQ,YAAR,CAAb,EAAmC;AAAA,uBAASC,CAAT,EAAW;AAACI,gBAAUJ,CAAV;AAAY;AAAxB,CAAnC,EAA6D,CAA7D;AAAgE,IAAIK,UAAJ,EAAeC,iBAAf,EAAiCC,kBAAjC;AAAoDV,OAAOC,KAAP,CAAaC,QAAQ,yBAAR,CAAb,EAAgD;AAACM,YAAD,YAAYL,CAAZ,EAAc;AAACK,iBAAWL,CAAX;AAAa,GAA5B;AAA6BM,mBAA7B,YAA+CN,CAA/C,EAAiD;AAACM,wBAAkBN,CAAlB;AAAoB,GAAtE;AAAuEO,oBAAvE,YAA0FP,CAA1F,EAA4F;AAACO,yBAAmBP,CAAnB;AAAqB;AAAlH,CAAhD,EAAoK,CAApK;AAAuK,IAAIQ,MAAJ;AAAWX,OAAOC,KAAP,CAAaC,QAAQ,eAAR,CAAb,EAAsC;AAACS,QAAD,YAAQR,CAAR,EAAU;AAACQ,aAAOR,CAAP;AAAS;AAApB,CAAtC,EAA4D,CAA5D;AAA+D,IAAIS,QAAJ;AAAaZ,OAAOC,KAAP,CAAaC,QAAQ,sBAAR,CAAb,EAA6C;AAACU,UAAD,YAAUT,CAAV,EAAY;AAACS,eAAST,CAAT;AAAW;AAAxB,CAA7C,EAAuE,CAAvE;AAA0E,IAAIU,MAAJ;AAAWb,OAAOC,KAAP,CAAaC,QAAQ,8BAAR,CAAb,EAAqD;AAACW,QAAD,YAAQV,CAAR,EAAU;AAACU,aAAOV,CAAP;AAAS;AAApB,CAArD,EAA2E,CAA3E;AAA8E,IAAIW,mBAAJ,EAAwBC,sBAAxB;AAA+Cf,OAAOC,KAAP,CAAaC,QAAQ,YAAR,CAAb,EAAmC;AAACY,qBAAD,YAAqBX,CAArB,EAAuB;AAACW,0BAAoBX,CAApB;AAAsB,GAA9C;AAA+CY,wBAA/C,YAAsEZ,CAAtE,EAAwE;AAACY,6BAAuBZ,CAAvB;AAAyB;AAAlG,CAAnC,EAAuI,CAAvI;AAA0I,IAAIa,mBAAJ;AAAwBhB,OAAOC,KAAP,CAAaC,QAAQ,2BAAR,CAAb,EAAkD;AAACc,qBAAD,YAAqBb,CAArB,EAAuB;AAACa,0BAAoBb,CAApB;AAAsB;AAA9C,CAAlD,EAAkG,CAAlG;;IAUh/Bc,a;;;;;AAOJ,yBAAYC,KAAZ,EAAmB;AAAA;;AACjB,kCAAMA,KAAN;;AADiB,UAkBnBC,gBAlBmB,GAkBA,UAACC,KAAD,EAAQC,KAAR,EAAeC,QAAf,EAA4B;AAC7CF,YAAMG,cAAN;;AAEA,YAAKC,QAAL,CAAc;AACZC,mBAAW;AADC,OAAd;;AAGA,UAAMC,SAAS,EAAf;AACA,UAAMC,WAAWN,QAAQA,MAAMO,IAAN,EAAR,GAAuB,IAAxC;AACA,UAAMC,QAAQP,WAAWA,SAASM,IAAT,EAAX,GAA6B,IAA3C;AAEA,UAAME,iBAAiBd,oBAAoBK,KAApB,CAA0BM,QAA1B,CAAvB;AACA,UAAMI,oBAAoBf,oBAAoBM,QAApB,CAA6BO,KAA7B,EAAoC;AAAEG,yBAAiB;AAAnB,OAApC,CAA1B;;AAEA,UAAIF,mBAAmB,IAAvB,EAA6B;AAC3BJ,eAAOL,KAAP,GAAeS,cAAf;AACD;;AAED,UAAIC,sBAAsB,IAA1B,EAAgC;AAC9BL,eAAOJ,QAAP,GAAkBS,iBAAlB;AACD;;AAED,UAAI,SAAUL,MAAV,MAAsB,KAA1B,EAAiC;AAC/B,cAAKF,QAAL,CAAc;AACZC,qBAAW,KADC;AAEZQ,wBAAc;AACZP;AADY;AAFF,SAAd;;AAMA;AACD;;AAED,UAAI,MAAKR,KAAL,CAAWgB,WAAX,KAA2B,qBAA/B,EAAsD;AACpDvB,eAAOwB,iBAAP,CAAyBR,QAAzB,EAAmCE,KAAnC,EAA0C,UAACO,KAAD,EAAW;AACnD,cAAIA,KAAJ,EAAW;AACT,kBAAKZ,QAAL,CAAc;AACZC,yBAAW,KADC;AAEZQ,4BAAc;AACZI,wBAAQ,CAACD,KAAD;AADI;AAFF,aAAd;AAMD,WAPD,MAOO;AACLvB,mBAAOyB,EAAP,CAAU,MAAKpB,KAAL,CAAWqB,YAAX,CAAwBC,KAAxB,CAA8BC,IAAxC;AACD;AACF,SAXD;AAYD,OAbD,MAaO,IAAI,MAAKvB,KAAL,CAAWgB,WAAX,KAA2B,qBAA/B,EAAsD;AAC3D,YAAMQ,cAAc;AAClBrB,iBAAOM,QADW;AAElBL,oBAAUO;AAFQ,SAApB;AAKAjB,iBAAS+B,UAAT,CAAoBD,WAApB,EAAiC,UAACN,KAAD,EAAW;AAC1C,cAAIA,KAAJ,EAAW;AACT,kBAAKZ,QAAL,CAAc;AACZC,yBAAW,KADC;AAEZQ,4BAAc;AACZI,wBAAQ,CAACD,KAAD;AADI;AAFF,aAAd;AAMD,WAPD,MAOO;AACLvB,mBAAOyB,EAAP,CAAU,MAAKpB,KAAL,CAAWqB,YAAX,CAAwBC,KAAxB,CAA8BC,IAAxC;AACD;AACF,SAXD;AAYD;AACF,KAjFkB;;AAAA,UAmFnBG,QAnFmB,GAmFR,UAACR,KAAD,EAAW;AACpB;AACA;AACA,UAAIA,UAAU,IAAV,IAAkB,OAAOA,KAAP,KAAiB,WAAvC,EAAoD;AAClD,eAAO,IAAP;AACD;;AAED,aAAO,KAAP;AACD,KA3FkB;;AAAA,UA6FnBH,YA7FmB,GA6FJ;AAAA,aACb,oBAAC,UAAD,CAAY,iBAAZ;AACE,kBAAU,MAAKY,KAAL,CAAWZ;AADvB,QADa;AAAA,KA7FI;;AAAA,UAmGnBa,QAnGmB,GAmGR,YAAM;AACf,UAAMC,gBAAgB,IAAIjC,mBAAJ,EAAtB;AACA,aAAOiC,cAAcD,QAAd,EAAP;AACD,KAtGkB;;AAAA,UAwGnBE,mBAxGmB,GAwGG,YAAM;AAC1B,UAAMD,gBAAgB,IAAIjC,mBAAJ,EAAtB;AACA,UAAMgC,WAAWC,cAAcD,QAAd,EAAjB;;AACA,UAAMG,kBAAkB,QAASH,QAAT,EAAmB;AACzCI,iBAAS;AADgC,OAAnB,CAAxB;;AAIA,aAAO,CAAC,CAACC,QAAQ,mBAAR,CAAF,IAAkCF,gBAAgBG,MAAhB,GAAyB,CAAlE;AACD,KAhHkB;;AAAA,UAkHnBC,cAlHmB,GAkHF,UAACC,GAAD;AAAA,aAASvC,uBAAuBwC,UAAvB,CAAkCD,GAAlC,CAAT;AAAA,KAlHE;;AAAA,UAoHnBE,iBApHmB,GAoHC,UAACC,KAAD,EAAW;AAC7B,UAAIC,cAAcD,KAAlB,CAD6B,CAG7B;;AACA,UAAIC,gBAAgB,kBAApB,EAAwC;AACtCA,sBAAc,wBAAd;AACD,OAFD,MAEO;AACLA,sBAAc,MAAKL,cAAL,CAAoBK,WAApB,CAAd;AACD;;AAED,UAAMC,mBAAmBhD,qBAAmB+C,WAAnB,CAAzB;AACA,UAAME,UAAU,EAAhB,CAX6B,CAWT;;AAEpBD,uBAAiBC,OAAjB,EAA0B,UAACxB,KAAD,EAAW;AACnC,YAAIA,KAAJ,EAAW;AACT,gBAAKZ,QAAL,CAAc;AACZS,0BAAc;AACZI,sBAAQ,CAACD,KAAD;AADI;AADF,WAAd;AAKD;AACF,OARD;AASD,KA1IkB;;AAAA,UA4InByB,kBA5ImB,GA4IE;AAAA,aAAM,CAAC,CAACV,QAAQ,mBAAR,CAAR;AAAA,KA5IF;;AAGjB,UAAKN,KAAL,GAAa;AACXZ,oBAAcf,MAAMe,YAAN,IAAsB,EADzB;AAEXR,iBAAW;AAFA,KAAb;AAKA,UAAKN,gBAAL,GAAwB,MAAKA,gBAAL,CAAsB2C,IAAtB,6CAAxB;AACA,UAAKlB,QAAL,GAAgB,MAAKA,QAAL,CAAckB,IAAd,6CAAhB;AACA,UAAK7B,YAAL,GAAoB,MAAKA,YAAL,CAAkB6B,IAAlB,6CAApB;AACA,UAAKhB,QAAL,GAAgB,MAAKA,QAAL,CAAcgB,IAAd,6CAAhB;AACA,UAAKd,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBc,IAAzB,6CAA3B;AACA,UAAKN,iBAAL,GAAyB,MAAKA,iBAAL,CAAuBM,IAAvB,6CAAzB;AACA,UAAKT,cAAL,GAAsB,MAAKA,cAAL,CAAoBS,IAApB,6CAAtB;AACA,UAAKD,kBAAL,GAA0B,MAAKA,kBAAL,CAAwBC,IAAxB,6CAA1B;AAfiB;AAgBlB;;;;SA8HDC,c;8BAAiB;AACf,UAAI,KAAK7C,KAAL,CAAWgB,WAAX,KAA2B,qBAA/B,EAAsD;AACpD,eACE,oBAAC,UAAD,CAAY,MAAZ,6BACM,KAAKhB,KADX;AAEE,wBAAc,KAAKC,gBAFrB;AAGE,oBAAU,KAAK0B,KAAL,CAAWZ,YAHvB;AAIE,mBAAS,KAAKW,QAJhB;AAKE,6BAAmB,KAAKX,YAL1B;AAME,qBAAW,KAAKY,KAAL,CAAWpB;AANxB,WADF;AAUD,OAXD,MAWO,IAAI,KAAKP,KAAL,CAAWgB,WAAX,KAA2B,qBAA/B,EAAsD;AAC3D,eACE,oBAAC,UAAD,CAAY,MAAZ,6BACM,KAAKhB,KADX;AAEE,wBAAc,KAAKC,gBAFrB;AAGE,oBAAU,KAAK0B,KAAL,CAAWZ,YAHvB;AAIE,mBAAS,KAAKW,QAJhB;AAKE,6BAAmB,KAAKX,YAL1B;AAME,8BAAoB,KAAK4B,kBAN3B;AAOE,qBAAW,KAAKhB,KAAL,CAAWpB;AAPxB,WADF;AAWD;AACF;;;;;SAEDuC,M;sBAAS;AACP,aACE,iCACE,oBAAC,UAAD,CAAY,YAAZ;AACE,uBAAe,KAAKlB,QADtB;AAEE,qBAAa,KAAK5B,KAAL,CAAWgB,WAF1B;AAGE,qBAAa,KAAKc,mBAHpB;AAIE,uBAAe,KAAKQ,iBAJtB;AAKE,wBAAgB,KAAKH;AALvB,QADF,EAQG,KAAKU,cAAL,EARH,CADF;AAYD;;;;;;EA7LyBzD,S;;AAAtBW,a,CACGgD,S,GAAY;AACjB1B,gBAAchC,UAAU2D,MADP;AAEjBhC,eAAa3B,UAAU4D,MAFN;AAGjBlC,gBAAc1B,UAAU2D;AAHP,C;;AA+LrB,SAASE,QAAT,CAAkBlD,KAAlB,EAAyBmD,MAAzB,EAAiC;AAC/BA,SAAO,IAAP,EAAa;AAAE9B,kBAAc1B,OAAOyD,OAAP;AAAhB,GAAb;AACD;;AAED7D,kBAAkB,eAAlB,EAAmCQ,aAAnC,EAAkDP,mBAAmB0D,QAAnB,CAAlD;AA9MApE,OAAOuE,aAAP,CAgNe7D,mBAAmB0D,QAAnB,EAA6BnD,aAA7B,CAhNf","sourcesContent":["import _ from \"lodash\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Components, registerComponent, composeWithTracker } from \"@reactioncommerce/reaction-components\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Accounts } from \"meteor/accounts-base\";\nimport { Router } from \"/client/api\";\nimport { ServiceConfigHelper, LoginFormSharedHelpers } from \"../helpers\";\nimport { LoginFormValidation } from \"/lib/api\";\n\nclass AuthContainer extends Component {\n  static propTypes = {\n    currentRoute: PropTypes.object,\n    currentView: PropTypes.string,\n    formMessages: PropTypes.object\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      formMessages: props.formMessages || {},\n      isLoading: false\n    };\n\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    this.hasError = this.hasError.bind(this);\n    this.formMessages = this.formMessages.bind(this);\n    this.services = this.services.bind(this);\n    this.shouldShowSeperator = this.shouldShowSeperator.bind(this);\n    this.handleSocialLogin = this.handleSocialLogin.bind(this);\n    this.capitalizeName = this.capitalizeName.bind(this);\n    this.hasPasswordService = this.hasPasswordService.bind(this);\n  }\n\n  handleFormSubmit = (event, email, password) => {\n    event.preventDefault();\n\n    this.setState({\n      isLoading: true\n    });\n    const errors = {};\n    const username = email ? email.trim() : null;\n    const pword = password ? password.trim() : null;\n\n    const validatedEmail = LoginFormValidation.email(username);\n    const validatedPassword = LoginFormValidation.password(pword, { validationLevel: \"exists\" });\n\n    if (validatedEmail !== true) {\n      errors.email = validatedEmail;\n    }\n\n    if (validatedPassword !== true) {\n      errors.password = validatedPassword;\n    }\n\n    if (_.isEmpty(errors) === false) {\n      this.setState({\n        isLoading: false,\n        formMessages: {\n          errors\n        }\n      });\n      return;\n    }\n\n    if (this.props.currentView === \"loginFormSignInView\") {\n      Meteor.loginWithPassword(username, pword, (error) => {\n        if (error) {\n          this.setState({\n            isLoading: false,\n            formMessages: {\n              alerts: [error]\n            }\n          });\n        } else {\n          Router.go(this.props.currentRoute.route.path);\n        }\n      });\n    } else if (this.props.currentView === \"loginFormSignUpView\") {\n      const newUserData = {\n        email: username,\n        password: pword\n      };\n\n      Accounts.createUser(newUserData, (error) => {\n        if (error) {\n          this.setState({\n            isLoading: false,\n            formMessages: {\n              alerts: [error]\n            }\n          });\n        } else {\n          Router.go(this.props.currentRoute.route.path);\n        }\n      });\n    }\n  }\n\n  hasError = (error) => {\n    // True here means the field is valid\n    // We're checking if theres some other message to display\n    if (error !== true && typeof error !== \"undefined\") {\n      return true;\n    }\n\n    return false;\n  }\n\n  formMessages = () => (\n    <Components.LoginFormMessages\n      messages={this.state.formMessages}\n    />\n  )\n\n  services = () => {\n    const serviceHelper = new ServiceConfigHelper();\n    return serviceHelper.services();\n  }\n\n  shouldShowSeperator = () => {\n    const serviceHelper = new ServiceConfigHelper();\n    const services = serviceHelper.services();\n    const enabledServices = _.filter(services, {\n      enabled: true\n    });\n\n    return !!Package[\"accounts-password\"] && enabledServices.length > 0;\n  }\n\n  capitalizeName = (str) => LoginFormSharedHelpers.capitalize(str)\n\n  handleSocialLogin = (value) => {\n    let serviceName = value;\n\n    // Get proper service name\n    if (serviceName === \"meteor-developer\") {\n      serviceName = \"MeteorDeveloperAccount\";\n    } else {\n      serviceName = this.capitalizeName(serviceName);\n    }\n\n    const loginWithService = Meteor[`loginWith${serviceName}`];\n    const options = {}; // use default scope unless specified\n\n    loginWithService(options, (error) => {\n      if (error) {\n        this.setState({\n          formMessages: {\n            alerts: [error]\n          }\n        });\n      }\n    });\n  }\n\n  hasPasswordService = () => !!Package[\"accounts-password\"]\n\n  renderAuthView() {\n    if (this.props.currentView === \"loginFormSignInView\") {\n      return (\n        <Components.SignIn\n          {...this.props}\n          onFormSubmit={this.handleFormSubmit}\n          messages={this.state.formMessages}\n          onError={this.hasError}\n          loginFormMessages={this.formMessages}\n          isLoading={this.state.isLoading}\n        />\n      );\n    } else if (this.props.currentView === \"loginFormSignUpView\") {\n      return (\n        <Components.SignUp\n          {...this.props}\n          onFormSubmit={this.handleFormSubmit}\n          messages={this.state.formMessages}\n          onError={this.hasError}\n          loginFormMessages={this.formMessages}\n          hasPasswordService={this.hasPasswordService}\n          isLoading={this.state.isLoading}\n        />\n      );\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Components.LoginButtons\n          loginServices={this.services}\n          currentView={this.props.currentView}\n          onSeparator={this.shouldShowSeperator}\n          onSocialClick={this.handleSocialLogin}\n          capitalizeName={this.capitalizeName}\n        />\n        {this.renderAuthView()}\n      </div>\n    );\n  }\n}\n\nfunction composer(props, onData) {\n  onData(null, { currentRoute: Router.current() });\n}\n\nregisterComponent(\"AuthContainer\", AuthContainer, composeWithTracker(composer));\n\nexport default composeWithTracker(composer)(AuthContainer);\n"]},"sourceType":"script","hash":"f9a4e88ac9944136ec8c874e1f40e57fb8f3b36b"}
