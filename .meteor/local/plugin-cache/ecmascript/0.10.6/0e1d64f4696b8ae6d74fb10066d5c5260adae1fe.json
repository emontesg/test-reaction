{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/accounts/client/containers/passwordOverlay.js","filename":"imports/plugins/core/accounts/client/containers/passwordOverlay.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/accounts/client/containers/passwordOverlay.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/accounts/client/containers/passwordOverlay.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/accounts/client/containers/passwordOverlay.js"}},"code":"var _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _isEmpty;\n\nmodule.watch(require(\"lodash/isEmpty\"), {\n  \"default\": function (v) {\n    _isEmpty = v;\n  }\n}, 0);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 1);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 2);\nvar Accounts;\nmodule.watch(require(\"meteor/accounts-base\"), {\n  Accounts: function (v) {\n    Accounts = v;\n  }\n}, 3);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 4);\nvar Random;\nmodule.watch(require(\"meteor/random\"), {\n  Random: function (v) {\n    Random = v;\n  }\n}, 5);\nvar Components, registerComponent;\nmodule.watch(require(\"../../../components/lib\"), {\n  Components: function (v) {\n    Components = v;\n  },\n  registerComponent: function (v) {\n    registerComponent = v;\n  }\n}, 6);\nvar Reaction;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 7);\nvar LoginFormValidation;\nmodule.watch(require(\"../../../../../../lib/api\"), {\n  LoginFormValidation: function (v) {\n    LoginFormValidation = v;\n  }\n}, 8);\nvar UpdatePasswordOverlay;\nmodule.watch(require(\"../components/updatePasswordOverlay\"), {\n  \"default\": function (v) {\n    UpdatePasswordOverlay = v;\n  }\n}, 9);\n\nvar wrapComponent = function (Comp) {\n  var _class, _temp;\n\n  return _temp = _class =\n  /*#__PURE__*/\n  function (_Component) {\n    (0, _inheritsLoose2.default)(UpdatePasswordOverlayContainer, _Component);\n\n    function UpdatePasswordOverlayContainer(props) {\n      var _this;\n\n      _this = _Component.call(this, props) || this;\n\n      _this.handleFormSubmit = function (event, passwordValue) {\n        event.preventDefault();\n\n        _this.setState({\n          isDisabled: true\n        });\n\n        var password = passwordValue.trim();\n        var validatedPassword = LoginFormValidation.password(password);\n        var errors = {};\n\n        if (validatedPassword !== true) {\n          errors.password = validatedPassword;\n        }\n\n        if (_isEmpty(errors) === false) {\n          _this.setState({\n            isDisabled: false,\n            formMessages: {\n              errors: errors\n            }\n          });\n\n          return;\n        }\n\n        Accounts.resetPassword(_this.props.token, password, function (error) {\n          if (error) {\n            _this.setState({\n              isDisabled: false,\n              formMessages: {\n                alerts: [error]\n              }\n            });\n          } else {\n            // Now that Meteor.users is verified, we should do the same with the Accounts collection\n            Meteor.call(\"accounts/verifyAccount\");\n\n            _this.props.callback();\n\n            _this.setState({\n              isOpen: !_this.state.isOpen\n            });\n\n            var shopId = Reaction.getUserPreferences(\"reaction\", \"activeShopId\");\n            Reaction.setShopId(shopId);\n          }\n        });\n      };\n\n      _this.handleFormCancel = function (event) {\n        event.preventDefault();\n\n        _this.setState({\n          isOpen: !_this.state.isOpen\n        });\n      };\n\n      _this.formMessages = function () {\n        return React.createElement(Components.LoginFormMessages, {\n          messages: _this.state.formMessages\n        });\n      };\n\n      _this.hasError = function (error) {\n        // True here means the field is valid\n        // We're checking if theres some other message to display\n        if (error !== true && typeof error !== \"undefined\") {\n          return true;\n        }\n\n        return false;\n      };\n\n      _this.state = {\n        formMessages: props.formMessages,\n        isOpen: props.isOpen,\n        isDisabled: false\n      };\n      _this.handleFormSubmit = _this.handleFormSubmit.bind((0, _assertThisInitialized2.default)(_this));\n      _this.handleFormCancel = _this.handleFormCancel.bind((0, _assertThisInitialized2.default)(_this));\n      _this.formMessages = _this.formMessages.bind((0, _assertThisInitialized2.default)(_this));\n      _this.hasError = _this.hasError.bind((0, _assertThisInitialized2.default)(_this));\n      return _this;\n    }\n\n    var _proto = UpdatePasswordOverlayContainer.prototype;\n\n    _proto.render = function () {\n      function render() {\n        return React.createElement(Comp, {\n          uniqueId: this.props.uniqueId,\n          loginFormMessages: this.formMessages,\n          onError: this.hasError,\n          messages: this.state.formMessages,\n          onFormSubmit: this.handleFormSubmit,\n          onCancel: this.handleFormCancel,\n          isOpen: this.state.isOpen,\n          isDisabled: this.state.isDisabled,\n          type: this.props.type\n        });\n      }\n\n      return render;\n    }();\n\n    return UpdatePasswordOverlayContainer;\n  }(Component), _class.propTypes = {\n    callback: PropTypes.func,\n    formMessages: PropTypes.object,\n    isOpen: PropTypes.bool,\n    token: PropTypes.string,\n    type: PropTypes.string,\n    uniqueId: PropTypes.string\n  }, _class.defaultProps = {\n    formMessages: {},\n    uniqueId: Random.id()\n  }, _temp;\n};\n\nregisterComponent(\"UpdatePasswordOverlay\", UpdatePasswordOverlay, wrapComponent);\nmodule.exportDefault(wrapComponent(UpdatePasswordOverlay));","map":{"version":3,"sources":["imports/plugins/core/accounts/client/containers/passwordOverlay.js"],"names":["_isEmpty","module","watch","require","v","React","Component","PropTypes","Accounts","Meteor","Random","Components","registerComponent","Reaction","LoginFormValidation","UpdatePasswordOverlay","wrapComponent","Comp","props","handleFormSubmit","event","passwordValue","preventDefault","setState","isDisabled","password","trim","validatedPassword","errors","formMessages","resetPassword","token","error","alerts","call","callback","isOpen","state","shopId","getUserPreferences","setShopId","handleFormCancel","hasError","bind","render","uniqueId","type","propTypes","func","object","bool","string","defaultProps","id","exportDefault"],"mappings":"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","sourcesContent":["import _ from \"lodash\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Accounts } from \"meteor/accounts-base\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Random } from \"meteor/random\";\nimport { Components, registerComponent } from \"@reactioncommerce/reaction-components\";\nimport { Reaction } from \"/client/api\";\nimport { LoginFormValidation } from \"/lib/api\";\nimport UpdatePasswordOverlay from \"../components/updatePasswordOverlay\";\n\nconst wrapComponent = (Comp) => (\n  class UpdatePasswordOverlayContainer extends Component {\n    static propTypes = {\n      callback: PropTypes.func,\n      formMessages: PropTypes.object,\n      isOpen: PropTypes.bool,\n      token: PropTypes.string,\n      type: PropTypes.string,\n      uniqueId: PropTypes.string\n    }\n\n    static defaultProps = {\n      formMessages: {},\n      uniqueId: Random.id()\n    }\n\n    constructor(props) {\n      super(props);\n\n      this.state = {\n        formMessages: props.formMessages,\n        isOpen: props.isOpen,\n        isDisabled: false\n      };\n\n      this.handleFormSubmit = this.handleFormSubmit.bind(this);\n      this.handleFormCancel = this.handleFormCancel.bind(this);\n      this.formMessages = this.formMessages.bind(this);\n      this.hasError = this.hasError.bind(this);\n    }\n\n    handleFormSubmit = (event, passwordValue) => {\n      event.preventDefault();\n\n      this.setState({\n        isDisabled: true\n      });\n\n      const password = passwordValue.trim();\n      const validatedPassword = LoginFormValidation.password(password);\n      const errors = {};\n\n      if (validatedPassword !== true) {\n        errors.password = validatedPassword;\n      }\n\n      if (_.isEmpty(errors) === false) {\n        this.setState({\n          isDisabled: false,\n          formMessages: {\n            errors\n          }\n        });\n        return;\n      }\n\n      Accounts.resetPassword(this.props.token, password, (error) => {\n        if (error) {\n          this.setState({\n            isDisabled: false,\n            formMessages: {\n              alerts: [error]\n            }\n          });\n        } else {\n          // Now that Meteor.users is verified, we should do the same with the Accounts collection\n          Meteor.call(\"accounts/verifyAccount\");\n\n          this.props.callback();\n\n          this.setState({\n            isOpen: !this.state.isOpen\n          });\n\n          const shopId = Reaction.getUserPreferences(\"reaction\", \"activeShopId\");\n          Reaction.setShopId(shopId);\n        }\n      });\n    }\n\n    handleFormCancel = (event) => {\n      event.preventDefault();\n      this.setState({\n        isOpen: !this.state.isOpen\n      });\n    }\n\n    formMessages = () => (\n      <Components.LoginFormMessages messages={this.state.formMessages} />\n    )\n\n    hasError = (error) => {\n      // True here means the field is valid\n      // We're checking if theres some other message to display\n      if (error !== true && typeof error !== \"undefined\") {\n        return true;\n      }\n\n      return false;\n    }\n\n    render() {\n      return (\n        <Comp\n          uniqueId={this.props.uniqueId}\n          loginFormMessages={this.formMessages}\n          onError={this.hasError}\n          messages={this.state.formMessages}\n          onFormSubmit={this.handleFormSubmit}\n          onCancel={this.handleFormCancel}\n          isOpen={this.state.isOpen}\n          isDisabled={this.state.isDisabled}\n          type={this.props.type}\n        />\n      );\n    }\n  }\n);\n\nregisterComponent(\"UpdatePasswordOverlay\", UpdatePasswordOverlay, wrapComponent);\n\nexport default wrapComponent(UpdatePasswordOverlay);\n"]},"sourceType":"script","hash":"0e1d64f4696b8ae6d74fb10066d5c5260adae1fe"}
