{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/i18n/client/containers/localizationSettings.js","filename":"imports/plugins/core/i18n/client/containers/localizationSettings.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/i18n/client/containers/localizationSettings.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/i18n/client/containers/localizationSettings.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/i18n/client/containers/localizationSettings.js"}},"code":"var _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _compose;\n\nmodule.watch(require(\"recompose/compose\"), {\n  \"default\": function (v) {\n    _compose = v;\n  }\n}, 0);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 1);\nvar registerComponent, composeWithTracker, withMomentTimezone;\nmodule.watch(require(\"../../../components/lib\"), {\n  registerComponent: function (v) {\n    registerComponent = v;\n  },\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  },\n  withMomentTimezone: function (v) {\n    withMomentTimezone = v;\n  }\n}, 2);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 3);\nvar Reaction, i18next;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  Reaction: function (v) {\n    Reaction = v;\n  },\n  i18next: function (v) {\n    i18next = v;\n  }\n}, 4);\nvar Countries;\nmodule.watch(require(\"../../../../../../client/collections\"), {\n  Countries: function (v) {\n    Countries = v;\n  }\n}, 5);\nvar Shops;\nmodule.watch(require(\"../../../../../../lib/collections\"), {\n  Shops: function (v) {\n    Shops = v;\n  }\n}, 6);\nvar LocalizationSettings;\nmodule.watch(require(\"../components/localizationSettings\"), {\n  \"default\": function (v) {\n    LocalizationSettings = v;\n  }\n}, 7);\n\nvar wrapComponent = function (Comp) {\n  var _class, _temp2;\n\n  return _temp2 = _class =\n  /*#__PURE__*/\n  function (_Component) {\n    (0, _inheritsLoose2.default)(LocalizationSettingsContainer, _Component);\n\n    function LocalizationSettingsContainer() {\n      var _temp, _this;\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return (_temp = _this = _Component.call.apply(_Component, [this].concat(args)) || this, _this.handleUpdateLanguageConfiguration = function (event, isChecked, name) {\n        var language = _this.props.languages.find(function (l) {\n          return l.value === name;\n        });\n\n        if (language) {\n          Meteor.call(\"shop/updateLanguageConfiguration\", language.value, isChecked);\n        }\n      }, _this.handleUpdateCurrencyConfiguration = function (event, isChecked, name) {\n        Meteor.call(\"shop/updateCurrencyConfiguration\", name, isChecked);\n      }, _this.handleSubmit = function (doc) {\n        Shops.update({\n          _id: doc._id\n        }, {\n          $set: {\n            timezone: doc.timezone,\n            currency: doc.currency,\n            baseUOM: doc.baseUOM,\n            baseUOL: doc.baseUOL,\n            language: doc.language\n          }\n        });\n      }, _this.handleEnableAllLanguages = function (isEnabled) {\n        Meteor.call(\"shop/updateLanguageConfiguration\", \"all\", isEnabled);\n      }, _this.handleEnableAllCurrencies = function (isEnabled) {\n        Meteor.call(\"shop/updateCurrencyConfiguration\", \"all\", isEnabled);\n      }, _this.handleTranslationReload = function (flushAll) {\n        if (flushAll === true) {\n          Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllStarted\", {\n            defaultValue: \"Reloading translations for all shops.\"\n          }), \"info\");\n          Meteor.call(\"i18n/flushTranslations\", function (error) {\n            if (!error) {\n              Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllSuccess\", {\n                defaultValue: \"Translations have been reloaded for all shops.\"\n              }), \"success\");\n            } else {\n              Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllFail\", {\n                defaultValue: \"Translations could not be reloaded for all shops.\"\n              }), \"error\");\n            }\n          });\n        } else {\n          Alerts.toast(i18next.t(\"admin.i18nSettings.reloadStarted\", {\n            defaultValue: \"Reloading translations for the current shop.\"\n          }), \"info\");\n          Meteor.call(\"i18n/flushTranslations\", function (error) {\n            if (!error) {\n              Alerts.toast(i18next.t(\"admin.i18nSettings.reloadSuccess\", {\n                defaultValue: \"Translations have been reloaded for the current shop.\"\n              }), \"success\");\n            } else {\n              Alerts.toast(i18next.t(\"admin.i18nSettings.reloadFail\", {\n                defaultValue: \"Translations could not be reloaded for the current shop.\"\n              }), \"error\");\n            }\n          });\n        }\n      }, _temp) || (0, _assertThisInitialized2.default)(_this);\n    }\n\n    var _proto = LocalizationSettingsContainer.prototype;\n\n    _proto.render = function () {\n      function render() {\n        return React.createElement(Comp, (0, _extends2.default)({}, this.props, {\n          onEnableAllCurrencies: this.handleEnableAllCurrencies,\n          onEnableAllLanguages: this.handleEnableAllLanguages,\n          onUpdateCurrencyConfiguration: this.handleUpdateCurrencyConfiguration,\n          onUpdateLanguageConfiguration: this.handleUpdateLanguageConfiguration,\n          onUpdateLocalization: this.handleSubmit,\n          onReloadTranslations: this.handleTranslationReload\n        }));\n      }\n\n      return render;\n    }();\n\n    return LocalizationSettingsContainer;\n  }(Component), _class.propTypes = LocalizationSettings.propTypes, _temp2;\n};\n\nfunction composer(props, onData) {\n  var languages = [];\n  var shop = Shops.findOne();\n  var countries = Countries.find().fetch();\n  var preferences = Reaction.getUserPreferences(\"reaction-i18n\", \"settingsCards\", {});\n\n  if ((0, _typeof2.default)(shop) === \"object\" && shop.languages) {\n    for (var _iterator = shop.languages, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var _language = _ref;\n\n      var i18nKey = \"languages.\" + _language.label.toLowerCase();\n\n      languages.push({\n        label: _language.label,\n        value: _language.i18n,\n        enabled: _language.i18n === shop.language || _language.enabled,\n        i18nKey: i18nKey\n      });\n    }\n  }\n\n  var currencies = shop.currencies;\n  var currencyList = [];\n  var currencyOptions = [];\n\n  for (var currency in meteorBabelHelpers.sanitizeForInObject(currencies)) {\n    if ({}.hasOwnProperty.call(currencies, currency)) {\n      if (currency === \"updatedAt\") {\n        continue;\n      }\n\n      var structure = currencies[currency];\n\n      var _label = currency + \"  |  \" + structure.symbol + \"  |  \" + structure.format;\n\n      currencyList.push({\n        name: currency,\n        label: _label,\n        enabled: structure.enabled || currency === shop.currency\n      });\n\n      if (structure.enabled || currency === shop.currency) {\n        currencyOptions.push({\n          label: _label,\n          value: currency\n        });\n      }\n    }\n  }\n\n  var _Shops$findOne = Shops.findOne(),\n      unitsOfMeasure = _Shops$findOne.unitsOfMeasure;\n\n  var uomOptions = [];\n\n  if (Array.isArray(unitsOfMeasure)) {\n    for (var _iterator2 = unitsOfMeasure, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n      var _ref2;\n\n      if (_isArray2) {\n        if (_i2 >= _iterator2.length) break;\n        _ref2 = _iterator2[_i2++];\n      } else {\n        _i2 = _iterator2.next();\n        if (_i2.done) break;\n        _ref2 = _i2.value;\n      }\n\n      var _measure = _ref2;\n      uomOptions.push({\n        label: i18next.t(\"uom.\" + _measure.uom, {\n          defaultValue: _measure.uom\n        }),\n        value: _measure.uom\n      });\n    }\n  }\n\n  var _Shops$findOne2 = Shops.findOne(),\n      unitsOfLength = _Shops$findOne2.unitsOfLength;\n\n  var uolOptions = [];\n\n  if (Array.isArray(unitsOfLength)) {\n    for (var _iterator3 = unitsOfLength, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n      var _ref3;\n\n      if (_isArray3) {\n        if (_i3 >= _iterator3.length) break;\n        _ref3 = _iterator3[_i3++];\n      } else {\n        _i3 = _iterator3.next();\n        if (_i3.done) break;\n        _ref3 = _i3.value;\n      }\n\n      var _length = _ref3;\n      uolOptions.push({\n        label: i18next.t(\"uol.\" + _length.uol, {\n          defaultValue: _length.uol\n        }),\n        value: _length.uol\n      });\n    }\n  }\n\n  var label = i18next.t(\"app.timezoneOptions\", \"Choose timezone\");\n  var timezoneOptions = [{\n    value: \"\",\n    label: label\n  }];\n  var moment = props.momentTimezone;\n\n  if (moment) {\n    var timezones = moment.names();\n\n    for (var _iterator4 = timezones, _isArray4 = Array.isArray(_iterator4), _i4 = 0, _iterator4 = _isArray4 ? _iterator4 : _iterator4[Symbol.iterator]();;) {\n      var _ref4;\n\n      if (_isArray4) {\n        if (_i4 >= _iterator4.length) break;\n        _ref4 = _iterator4[_i4++];\n      } else {\n        _i4 = _iterator4.next();\n        if (_i4.done) break;\n        _ref4 = _i4.value;\n      }\n\n      var _timezone = _ref4;\n      timezoneOptions.push({\n        value: _timezone,\n        label: _timezone\n      });\n    }\n  }\n\n  onData(null, {\n    preferences: preferences,\n    shop: shop,\n    languages: languages,\n    currencies: currencyList,\n    enabledLanguages: languages.filter(function (language) {\n      return language.enabled || language.value === shop.language;\n    }),\n    countryOptions: countries,\n    currencyOptions: currencyOptions,\n    uomOptions: uomOptions,\n    uolOptions: uolOptions,\n    timezoneOptions: timezoneOptions\n  });\n}\n\nregisterComponent(\"i18nSettings\", LocalizationSettings, [withMomentTimezone, composeWithTracker(composer), wrapComponent]);\nmodule.exportDefault(_compose(withMomentTimezone, composeWithTracker(composer), wrapComponent)(LocalizationSettings));","map":{"version":3,"sources":["imports/plugins/core/i18n/client/containers/localizationSettings.js"],"names":["_compose","module","watch","require","v","React","Component","registerComponent","composeWithTracker","withMomentTimezone","Meteor","Reaction","i18next","Countries","Shops","LocalizationSettings","wrapComponent","Comp","handleUpdateLanguageConfiguration","event","isChecked","name","language","props","languages","find","l","value","call","handleUpdateCurrencyConfiguration","handleSubmit","doc","update","_id","$set","timezone","currency","baseUOM","baseUOL","handleEnableAllLanguages","isEnabled","handleEnableAllCurrencies","handleTranslationReload","flushAll","Alerts","toast","t","defaultValue","error","render","propTypes","composer","onData","shop","findOne","countries","fetch","preferences","getUserPreferences","i18nKey","label","toLowerCase","push","i18n","enabled","currencies","currencyList","currencyOptions","hasOwnProperty","structure","symbol","format","unitsOfMeasure","uomOptions","Array","isArray","measure","uom","unitsOfLength","uolOptions","length","uol","timezoneOptions","moment","momentTimezone","timezones","names","enabledLanguages","filter","countryOptions","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { compose } from \"recompose\";\nimport { registerComponent, composeWithTracker, withMomentTimezone } from \"@reactioncommerce/reaction-components\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { Countries } from \"/client/collections\";\nimport { Shops } from \"/lib/collections\";\nimport LocalizationSettings from \"../components/localizationSettings\";\n\nconst wrapComponent = (Comp) => (\n  class LocalizationSettingsContainer extends Component {\n    static propTypes = LocalizationSettings.propTypes\n\n    handleUpdateLanguageConfiguration = (event, isChecked, name) => {\n      const language = this.props.languages.find((l) => l.value === name);\n\n      if (language) {\n        Meteor.call(\"shop/updateLanguageConfiguration\", language.value, isChecked);\n      }\n    }\n\n    handleUpdateCurrencyConfiguration = (event, isChecked, name) => {\n      Meteor.call(\"shop/updateCurrencyConfiguration\", name, isChecked);\n    }\n\n    handleSubmit = (doc) => {\n      Shops.update({\n        _id: doc._id\n      }, {\n        $set: {\n          timezone: doc.timezone,\n          currency: doc.currency,\n          baseUOM: doc.baseUOM,\n          baseUOL: doc.baseUOL,\n          language: doc.language\n        }\n      });\n    }\n\n    handleEnableAllLanguages = (isEnabled) => {\n      Meteor.call(\"shop/updateLanguageConfiguration\", \"all\", isEnabled);\n    }\n\n    handleEnableAllCurrencies = (isEnabled) => {\n      Meteor.call(\"shop/updateCurrencyConfiguration\", \"all\", isEnabled);\n    }\n\n    handleTranslationReload = (flushAll) => {\n      if (flushAll === true) {\n        Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllStarted\", { defaultValue: \"Reloading translations for all shops.\" }), \"info\");\n\n        Meteor.call(\"i18n/flushTranslations\", (error) => {\n          if (!error) {\n            Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllSuccess\", { defaultValue: \"Translations have been reloaded for all shops.\" }), \"success\");\n          } else {\n            Alerts.toast(i18next.t(\"admin.i18nSettings.reloadAllFail\", { defaultValue: \"Translations could not be reloaded for all shops.\" }), \"error\");\n          }\n        });\n      } else {\n        Alerts.toast(i18next.t(\"admin.i18nSettings.reloadStarted\", { defaultValue: \"Reloading translations for the current shop.\" }), \"info\");\n\n        Meteor.call(\"i18n/flushTranslations\", (error) => {\n          if (!error) {\n            Alerts.toast(i18next.t(\"admin.i18nSettings.reloadSuccess\", { defaultValue: \"Translations have been reloaded for the current shop.\" }), \"success\");\n          } else {\n            Alerts.toast(i18next.t(\"admin.i18nSettings.reloadFail\", { defaultValue: \"Translations could not be reloaded for the current shop.\" }), \"error\");\n          }\n        });\n      }\n    }\n\n    render() {\n      return (\n        <Comp\n          {...this.props}\n          onEnableAllCurrencies={this.handleEnableAllCurrencies}\n          onEnableAllLanguages={this.handleEnableAllLanguages}\n          onUpdateCurrencyConfiguration={this.handleUpdateCurrencyConfiguration}\n          onUpdateLanguageConfiguration={this.handleUpdateLanguageConfiguration}\n          onUpdateLocalization={this.handleSubmit}\n          onReloadTranslations={this.handleTranslationReload}\n        />\n      );\n    }\n  }\n);\n\nfunction composer(props, onData) {\n  const languages = [];\n  const shop = Shops.findOne();\n  const countries = Countries.find().fetch();\n  const preferences = Reaction.getUserPreferences(\"reaction-i18n\", \"settingsCards\", {});\n\n  if (typeof shop === \"object\" && shop.languages) {\n    for (const language of shop.languages) {\n      const i18nKey = `languages.${language.label.toLowerCase()}`;\n      languages.push({\n        label: language.label,\n        value: language.i18n,\n        enabled: (language.i18n === shop.language || language.enabled),\n        i18nKey\n      });\n    }\n  }\n\n  const { currencies } = shop;\n  const currencyList = [];\n  const currencyOptions = [];\n  for (const currency in currencies) {\n    if ({}.hasOwnProperty.call(currencies, currency)) {\n      if (currency === \"updatedAt\") {\n        continue;\n      }\n\n      const structure = currencies[currency];\n      const label = `${currency}  |  ${structure.symbol}  |  ${structure.format}`;\n\n      currencyList.push({\n        name: currency,\n        label,\n        enabled: (structure.enabled || currency === shop.currency)\n      });\n\n      if (structure.enabled || currency === shop.currency) {\n        currencyOptions.push({\n          label,\n          value: currency\n        });\n      }\n    }\n  }\n\n\n  const { unitsOfMeasure } = Shops.findOne();\n  const uomOptions = [];\n  if (Array.isArray(unitsOfMeasure)) {\n    for (const measure of unitsOfMeasure) {\n      uomOptions.push({\n        label: i18next.t(`uom.${measure.uom}`, { defaultValue: measure.uom }),\n        value: measure.uom\n      });\n    }\n  }\n\n  const { unitsOfLength } = Shops.findOne();\n  const uolOptions = [];\n  if (Array.isArray(unitsOfLength)) {\n    for (const length of unitsOfLength) {\n      uolOptions.push({\n        label: i18next.t(`uol.${length.uol}`, { defaultValue: length.uol }),\n        value: length.uol\n      });\n    }\n  }\n\n  const label = i18next.t(\"app.timezoneOptions\", \"Choose timezone\");\n  const timezoneOptions = [{\n    value: \"\",\n    label\n  }];\n  const moment = props.momentTimezone;\n  if (moment) {\n    const timezones = moment.names();\n    for (const timezone of timezones) {\n      timezoneOptions.push({\n        value: timezone,\n        label: timezone\n      });\n    }\n  }\n\n  onData(null, {\n    preferences,\n    shop,\n    languages,\n    currencies: currencyList,\n    enabledLanguages: languages.filter((language) => (language.enabled || language.value === shop.language)),\n    countryOptions: countries,\n    currencyOptions,\n    uomOptions,\n    uolOptions,\n    timezoneOptions\n  });\n}\n\nregisterComponent(\"i18nSettings\", LocalizationSettings, [\n  withMomentTimezone,\n  composeWithTracker(composer),\n  wrapComponent\n]);\n\nexport default compose(\n  withMomentTimezone,\n  composeWithTracker(composer),\n  wrapComponent\n)(LocalizationSettings);\n"]},"sourceType":"script","hash":"46b14f060436785049e055621965467cc3db8af3"}
