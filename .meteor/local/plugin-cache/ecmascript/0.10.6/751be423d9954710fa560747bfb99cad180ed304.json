{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/accounts/client/components/permissionsList.js","filename":"imports/plugins/core/accounts/client/components/permissionsList.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/accounts/client/components/permissionsList.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/accounts/client/components/permissionsList.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/accounts/client/components/permissionsList.js"}},"code":"var _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nvar _compact;\n\nmodule.watch(require(\"lodash/compact\"), {\n  \"default\": function (v) {\n    _compact = v;\n  }\n}, 0);\n\nvar _includes;\n\nmodule.watch(require(\"lodash/includes\"), {\n  \"default\": function (v) {\n    _includes = v;\n  }\n}, 1);\n\nvar _uniq;\n\nmodule.watch(require(\"lodash/uniq\"), {\n  \"default\": function (v) {\n    _uniq = v;\n  }\n}, 2);\n\nvar _remove;\n\nmodule.watch(require(\"lodash/remove\"), {\n  \"default\": function (v) {\n    _remove = v;\n  }\n}, 3);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 4);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 5);\nvar Components, registerComponent;\nmodule.watch(require(\"../../../components/lib\"), {\n  Components: function (v) {\n    Components = v;\n  },\n  registerComponent: function (v) {\n    registerComponent = v;\n  }\n}, 6);\n\n// resolvePermissions - helper to resolve toggled permission(s).\n// It returns a list of all parent and child permissions when a parent permission is toggled.\nfunction resolvePermissions(permission) {\n  var result = [];\n\n  if (permission.name) {\n    result.push(permission.name);\n\n    for (var _iterator = permission.permissions, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var _pkgPermissions = _ref;\n      result.push(_pkgPermissions.permission);\n    }\n  } else {\n    result.push(permission.permission);\n  }\n\n  return result;\n} // helper to remove all array items in \"old\" from \"current\"\n\n\nfunction removePermissions(current, old) {\n  var currentArray = _toConsumableArray(current);\n\n  old.forEach(function (val) {\n    _remove(currentArray, function (item) {\n      return item === val;\n    });\n  });\n  return currentArray;\n}\n\nvar PermissionsList =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inheritsLoose2.default)(PermissionsList, _Component);\n\n  function PermissionsList(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.togglePermission = function (toggledPermission) {\n      return function (event, checked) {\n        var groupData = Object.assign({}, _this.state.group);\n        var permissions = resolvePermissions(toggledPermission);\n\n        if (!groupData.permissions) {\n          groupData.permissions = [];\n        }\n\n        if (checked) {\n          groupData.permissions = _uniq(_toConsumableArray(groupData.permissions).concat(_toConsumableArray(permissions)));\n        } else {\n          groupData.permissions = removePermissions(groupData.permissions, permissions);\n        }\n\n        if (_this.props.updateGroup) {\n          return _this.props.updateGroup(_this.state.group._id, groupData);\n        }\n      };\n    };\n\n    _this.checked = function (permission) {\n      if (_includes(_this.state.group.permissions, permission)) {\n        return true;\n      }\n\n      return false;\n    };\n\n    _this.state = {\n      group: props.group\n    };\n    return _this;\n  }\n\n  var _proto = PermissionsList.prototype;\n\n  _proto.componentWillReceiveProps = function () {\n    function componentWillReceiveProps(nextProps) {\n      this.setState({\n        group: nextProps.group\n      });\n    }\n\n    return componentWillReceiveProps;\n  }();\n\n  _proto.renderSubPermissions = function () {\n    function renderSubPermissions(permission) {\n      var _this2 = this;\n\n      if (permission.permissions.length) {\n        return React.createElement(\"div\", {\n          className: \"child-item\"\n        }, permission.permissions.map(function (childPermission, index) {\n          return React.createElement(Components.ListItem, {\n            key: childPermission.name + \"-\" + index,\n            actionType: \"switch\",\n            label: childPermission.label,\n            switchOn: _this2.checked(childPermission.permission),\n            switchName: childPermission.permission,\n            onSwitchChange: _this2.togglePermission(childPermission)\n          });\n        }));\n      }\n\n      return null;\n    }\n\n    return renderSubPermissions;\n  }();\n\n  _proto.renderPermissions = function () {\n    function renderPermissions(permissions) {\n      var _this3 = this;\n\n      var jsx = [];\n      permissions.forEach(function (permission, key) {\n        jsx.push(React.createElement(\"div\", {\n          className: \"permission-item\",\n          key: permission.name + \"-\" + key\n        }, React.createElement(Components.ListItem, {\n          label: permission.label,\n          actionType: \"switch\",\n          switchOn: _this3.checked(permission.name),\n          switchName: permission.name,\n          onSwitchChange: _this3.togglePermission(permission)\n        }), _this3.renderSubPermissions(permission)));\n      });\n      return jsx;\n    }\n\n    return renderPermissions;\n  }();\n\n  _proto.render = function () {\n    function render() {\n      return React.createElement(\"div\", {\n        className: \"permissions-list\"\n      }, this.renderPermissions(_compact(this.props.permissions)));\n    }\n\n    return render;\n  }();\n\n  return PermissionsList;\n}(Component);\n\nPermissionsList.propTypes = {\n  createGroup: PropTypes.func,\n  group: PropTypes.object,\n  permissions: PropTypes.array,\n  updateGroup: PropTypes.func\n};\nregisterComponent(\"PermissionsList\", PermissionsList);\nmodule.exportDefault(PermissionsList);","map":{"version":3,"sources":["imports/plugins/core/accounts/client/components/permissionsList.js"],"names":["_compact","module","watch","require","v","_includes","_uniq","_remove","React","Component","PropTypes","Components","registerComponent","resolvePermissions","permission","result","name","push","permissions","pkgPermissions","removePermissions","current","old","currentArray","forEach","val","item","PermissionsList","props","togglePermission","toggledPermission","event","checked","groupData","Object","assign","state","group","updateGroup","_id","componentWillReceiveProps","nextProps","setState","renderSubPermissions","length","map","childPermission","index","label","renderPermissions","jsx","key","render","propTypes","createGroup","func","object","array","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport _ from \"lodash\";\nimport { Components, registerComponent } from \"@reactioncommerce/reaction-components\";\n\n// resolvePermissions - helper to resolve toggled permission(s).\n// It returns a list of all parent and child permissions when a parent permission is toggled.\nfunction resolvePermissions(permission) {\n  const result = [];\n\n  if (permission.name) {\n    result.push(permission.name);\n    for (const pkgPermissions of permission.permissions) {\n      result.push(pkgPermissions.permission);\n    }\n  } else {\n    result.push(permission.permission);\n  }\n\n  return result;\n}\n// helper to remove all array items in \"old\" from \"current\"\nfunction removePermissions(current, old) {\n  const currentArray = [...current];\n\n  old.forEach((val) => {\n    _.remove(currentArray, (item) => item === val);\n  });\n  return currentArray;\n}\n\nclass PermissionsList extends Component {\n  static propTypes = {\n    createGroup: PropTypes.func,\n    group: PropTypes.object,\n    permissions: PropTypes.array,\n    updateGroup: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      group: props.group\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState({ group: nextProps.group });\n  }\n\n  togglePermission = (toggledPermission) => (event, checked) => {\n    const groupData = Object.assign({}, this.state.group);\n    const permissions = resolvePermissions(toggledPermission);\n    if (!groupData.permissions) {\n      groupData.permissions = [];\n    }\n    if (checked) {\n      groupData.permissions = _.uniq([...groupData.permissions, ...permissions]);\n    } else {\n      groupData.permissions = removePermissions(groupData.permissions, permissions);\n    }\n\n    if (this.props.updateGroup) {\n      return this.props.updateGroup(this.state.group._id, groupData);\n    }\n  };\n\n  checked = (permission) => {\n    if (_.includes(this.state.group.permissions, permission)) {\n      return true;\n    }\n    return false;\n  };\n\n  renderSubPermissions(permission) {\n    if (permission.permissions.length) {\n      return (\n        <div className=\"child-item\">\n          {permission.permissions.map((childPermission, index) => (\n            <Components.ListItem\n              key={`${childPermission.name}-${index}`}\n              actionType=\"switch\"\n              label={childPermission.label}\n              switchOn={this.checked(childPermission.permission)}\n              switchName={childPermission.permission}\n              onSwitchChange={this.togglePermission(childPermission)}\n            />\n          ))}\n        </div>\n      );\n    }\n    return null;\n  }\n\n  renderPermissions(permissions) {\n    const jsx = [];\n    permissions.forEach((permission, key) => {\n      jsx.push(<div className=\"permission-item\" key={`${permission.name}-${key}`}>\n        <Components.ListItem\n          label={permission.label}\n          actionType=\"switch\"\n          switchOn={this.checked(permission.name)}\n          switchName={permission.name}\n          onSwitchChange={this.togglePermission(permission)}\n        />\n        {this.renderSubPermissions(permission)}\n      </div>);\n    });\n    return jsx;\n  }\n\n  render() {\n    return (\n      <div className=\"permissions-list\">\n        {this.renderPermissions(_.compact(this.props.permissions))}\n      </div>\n    );\n  }\n}\n\nregisterComponent(\"PermissionsList\", PermissionsList);\n\nexport default PermissionsList;\n"]},"sourceType":"script","hash":"751be423d9954710fa560747bfb99cad180ed304"}
