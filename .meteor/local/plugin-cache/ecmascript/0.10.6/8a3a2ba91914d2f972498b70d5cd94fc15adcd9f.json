{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$1$2","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"ast":true,"babelrc":false,"sourceFileName":"imports/plugins/core/orders/client/containers/orderSummaryContainer.js","filename":"imports/plugins/core/orders/client/containers/orderSummaryContainer.js","sourceMaps":true,"envName":"development","cwd":"/Users/estebandev/test-knowledge","passPerPreset":false,"parserOpts":{"sourceType":"module","sourceFileName":"imports/plugins/core/orders/client/containers/orderSummaryContainer.js","plugins":["dynamicImport","classProperties","jsx","jsx","flow","asyncGenerators","objectRestSpread","objectRestSpread","flow","asyncGenerators"]},"generatorOpts":{"filename":"imports/plugins/core/orders/client/containers/orderSummaryContainer.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/plugins/core/orders/client/containers/orderSummaryContainer.js"}},"code":"var _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _inheritsLoose2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inheritsLoose\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar _includes;\n\nmodule.watch(require(\"lodash/includes\"), {\n  \"default\": function (v) {\n    _includes = v;\n  }\n}, 0);\n\nvar _isArray;\n\nmodule.watch(require(\"lodash/isArray\"), {\n  \"default\": function (v) {\n    _isArray = v;\n  }\n}, 1);\n\nvar _every;\n\nmodule.watch(require(\"lodash/every\"), {\n  \"default\": function (v) {\n    _every = v;\n  }\n}, 2);\nvar React, Component;\nmodule.watch(require(\"react\"), {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 3);\nvar PropTypes;\nmodule.watch(require(\"prop-types\"), {\n  \"default\": function (v) {\n    PropTypes = v;\n  }\n}, 4);\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 5);\nvar composeWithTracker, withMoment;\nmodule.watch(require(\"../../../components/lib\"), {\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  },\n  withMoment: function (v) {\n    withMoment = v;\n  }\n}, 6);\nvar Orders;\nmodule.watch(require(\"../../../../../../lib/collections\"), {\n  Orders: function (v) {\n    Orders = v;\n  }\n}, 7);\nvar Card, CardHeader, CardBody, CardGroup;\nmodule.watch(require(\"../../../ui/client/components\"), {\n  Card: function (v) {\n    Card = v;\n  },\n  CardHeader: function (v) {\n    CardHeader = v;\n  },\n  CardBody: function (v) {\n    CardBody = v;\n  },\n  CardGroup: function (v) {\n    CardGroup = v;\n  }\n}, 8);\nvar i18next;\nmodule.watch(require(\"../../../../../../client/api\"), {\n  i18next: function (v) {\n    i18next = v;\n  }\n}, 9);\nvar OrderSummary;\nmodule.watch(require(\"../components/orderSummary\"), {\n  \"default\": function (v) {\n    OrderSummary = v;\n  }\n}, 10);\nvar getShippingInfo;\nmodule.watch(require(\"../helpers\"), {\n  getShippingInfo: function (v) {\n    getShippingInfo = v;\n  }\n}, 11);\n\nvar OrderSummaryContainer =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inheritsLoose2.default)(OrderSummaryContainer, _Component);\n\n  function OrderSummaryContainer(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.dateFormat = function (context, block) {\n      var moment = _this.props.moment;\n      var f = block || \"MMM DD, YYYY hh:mm:ss A\";\n      return moment && moment(context).format(f) || context.toLocaleString();\n    };\n\n    _this.tracking = function () {\n      var shipping = getShippingInfo(_this.props.order);\n\n      if (shipping.tracking) {\n        return shipping.tracking;\n      }\n\n      return i18next.t(\"orderShipping.noTracking\");\n    };\n\n    _this.shipmentStatus = function () {\n      var order = _this.props.order;\n      var shipment = getShippingInfo(_this.props.order);\n\n      if (shipment.delivered) {\n        return {\n          delivered: true,\n          shipped: true,\n          status: \"success\",\n          label: i18next.t(\"orderShipping.delivered\")\n        };\n      }\n\n      var shipped = _every(shipment.items, function (shipmentItem) {\n        for (var _iterator = order.items, _isArray2 = Array.isArray(_iterator), _i = 0, _iterator = _isArray2 ? _iterator : _iterator[Symbol.iterator]();;) {\n          var _ref;\n\n          if (_isArray2) {\n            if (_i >= _iterator.length) break;\n            _ref = _iterator[_i++];\n          } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref = _i.value;\n          }\n\n          var _fullItem = _ref;\n\n          if (_fullItem._id === shipmentItem._id) {\n            if (_fullItem.workflow) {\n              if (_isArray(_fullItem.workflow.workflow)) {\n                return _includes(_fullItem.workflow.workflow, \"coreOrderItemWorkflow/completed\");\n              }\n            }\n          }\n        }\n      });\n\n      var canceled = _every(shipment.items, function (shipmentItem) {\n        for (var _iterator2 = order.items, _isArray3 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray3 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n          var _ref2;\n\n          if (_isArray3) {\n            if (_i2 >= _iterator2.length) break;\n            _ref2 = _iterator2[_i2++];\n          } else {\n            _i2 = _iterator2.next();\n            if (_i2.done) break;\n            _ref2 = _i2.value;\n          }\n\n          var _fullItem2 = _ref2;\n\n          if (_fullItem2._id === shipmentItem._id) {\n            if (_fullItem2.workflow) {\n              return _fullItem2.workflow.status === \"coreOrderItemWorkflow/canceled\";\n            }\n          }\n        }\n      });\n\n      if (shipped) {\n        return {\n          delivered: false,\n          shipped: true,\n          status: \"success\",\n          label: i18next.t(\"orderShipping.shipped\")\n        };\n      }\n\n      if (canceled) {\n        return {\n          delivered: false,\n          shipped: false,\n          status: \"danger\",\n          label: i18next.t(\"order.canceledLabel\")\n        };\n      }\n\n      return {\n        delivered: false,\n        shipped: false,\n        status: \"info\",\n        label: i18next.t(\"orderShipping.notShipped\")\n      };\n    };\n\n    _this.printableLabels = function () {\n      var _getShippingInfo = getShippingInfo(_this.props.order),\n          shippingLabelUrl = _getShippingInfo.shippingLabelUrl,\n          customsLabelUrl = _getShippingInfo.customsLabelUrl;\n\n      if (shippingLabelUrl || customsLabelUrl) {\n        return {\n          shippingLabelUrl: shippingLabelUrl,\n          customsLabelUrl: customsLabelUrl\n        };\n      }\n\n      return false;\n    };\n\n    _this.dateFormat = _this.dateFormat.bind((0, _assertThisInitialized2.default)(_this));\n    _this.tracking = _this.tracking.bind((0, _assertThisInitialized2.default)(_this));\n    _this.shipmentStatus = _this.shipmentStatus.bind((0, _assertThisInitialized2.default)(_this));\n    return _this;\n  }\n\n  var _proto = OrderSummaryContainer.prototype;\n\n  _proto.render = function () {\n    function render() {\n      return React.createElement(CardGroup, null, React.createElement(Card, null, React.createElement(CardHeader, {\n        actAsExpander: false,\n        i18nKeyTitle: \"admin.orderWorkflow.summary.cardTitle\",\n        title: \"Summary\"\n      }), React.createElement(CardBody, {\n        expandable: false\n      }, React.createElement(OrderSummary, (0, _extends2.default)({}, this.props, {\n        dateFormat: this.dateFormat,\n        tracking: this.tracking,\n        shipmentStatus: this.shipmentStatus,\n        printableLabels: this.printableLabels\n      })))));\n    }\n\n    return render;\n  }();\n\n  return OrderSummaryContainer;\n}(Component);\n\nOrderSummaryContainer.propTypes = {\n  moment: PropTypes.func,\n  order: PropTypes.object\n};\n\nvar composer = function (props, onData) {\n  var query = {\n    _id: props.orderId\n  };\n  var options = {\n    limit: 1,\n    skip: 0\n  };\n  var orderSub = Meteor.subscribe(\"PaginatedOrders\", query, options);\n\n  if (orderSub.ready()) {\n    // Find current order\n    var order = Orders.findOne({\n      \"_id\": props.orderId,\n      \"shipping._id\": props.fulfillment && props.fulfillment._id\n    });\n\n    if (order) {\n      var profileShippingAddress = getShippingInfo(order).address || {};\n\n      if (order.workflow) {\n        if (order.workflow.status === \"coreOrderCreated\") {\n          order.workflow.status = \"coreOrderCreated\";\n          Meteor.call(\"workflow/pushOrderWorkflow\", \"coreOrderWorkflow\", \"coreOrderCreated\", order);\n        }\n      }\n\n      onData(null, {\n        order: order,\n        profileShippingAddress: profileShippingAddress\n      });\n    } else {\n      onData(null, {\n        order: {},\n        profileShippingAddress: {}\n      });\n    }\n  }\n};\n\nmodule.exportDefault(composeWithTracker(composer)(withMoment(OrderSummaryContainer)));","map":{"version":3,"sources":["imports/plugins/core/orders/client/containers/orderSummaryContainer.js"],"names":["_includes","module","watch","require","v","_isArray","_every","React","Component","PropTypes","Meteor","composeWithTracker","withMoment","Orders","Card","CardHeader","CardBody","CardGroup","i18next","OrderSummary","getShippingInfo","OrderSummaryContainer","props","dateFormat","context","block","moment","f","format","toLocaleString","tracking","shipping","order","t","shipmentStatus","shipment","delivered","shipped","status","label","items","shipmentItem","fullItem","_id","workflow","canceled","printableLabels","shippingLabelUrl","customsLabelUrl","bind","render","propTypes","func","object","composer","onData","query","orderId","options","limit","skip","orderSub","subscribe","ready","findOne","fulfillment","profileShippingAddress","address","call","exportDefault"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport _ from \"lodash\";\nimport { Meteor } from \"meteor/meteor\";\nimport { composeWithTracker, withMoment } from \"@reactioncommerce/reaction-components\";\nimport { Orders } from \"/lib/collections\";\nimport { Card, CardHeader, CardBody, CardGroup } from \"/imports/plugins/core/ui/client/components\";\nimport { i18next } from \"/client/api\";\nimport OrderSummary from \"../components/orderSummary\";\nimport { getShippingInfo } from \"../helpers\";\n\nclass OrderSummaryContainer extends Component {\n  static propTypes = {\n    moment: PropTypes.func,\n    order: PropTypes.object\n  }\n\n  constructor(props) {\n    super(props);\n    this.dateFormat = this.dateFormat.bind(this);\n    this.tracking = this.tracking.bind(this);\n    this.shipmentStatus = this.shipmentStatus.bind(this);\n  }\n\n  dateFormat = (context, block) => {\n    const { moment } = this.props;\n    const f = block || \"MMM DD, YYYY hh:mm:ss A\";\n    return (moment && moment(context).format(f)) || context.toLocaleString();\n  }\n\n  tracking = () => {\n    const shipping = getShippingInfo(this.props.order);\n    if (shipping.tracking) {\n      return shipping.tracking;\n    }\n    return i18next.t(\"orderShipping.noTracking\");\n  }\n\n  shipmentStatus = () => {\n    const { order } = this.props;\n    const shipment = getShippingInfo(this.props.order);\n\n    if (shipment.delivered) {\n      return {\n        delivered: true,\n        shipped: true,\n        status: \"success\",\n        label: i18next.t(\"orderShipping.delivered\")\n      };\n    }\n\n    const shipped = _.every(shipment.items, (shipmentItem) => {\n      for (const fullItem of order.items) {\n        if (fullItem._id === shipmentItem._id) {\n          if (fullItem.workflow) {\n            if (_.isArray(fullItem.workflow.workflow)) {\n              return _.includes(fullItem.workflow.workflow, \"coreOrderItemWorkflow/completed\");\n            }\n          }\n        }\n      }\n    });\n\n    const canceled = _.every(shipment.items, (shipmentItem) => {\n      for (const fullItem of order.items) {\n        if (fullItem._id === shipmentItem._id) {\n          if (fullItem.workflow) {\n            return fullItem.workflow.status === \"coreOrderItemWorkflow/canceled\";\n          }\n        }\n      }\n    });\n\n    if (shipped) {\n      return {\n        delivered: false,\n        shipped: true,\n        status: \"success\",\n        label: i18next.t(\"orderShipping.shipped\")\n      };\n    }\n\n    if (canceled) {\n      return {\n        delivered: false,\n        shipped: false,\n        status: \"danger\",\n        label: i18next.t(\"order.canceledLabel\")\n      };\n    }\n\n    return {\n      delivered: false,\n      shipped: false,\n      status: \"info\",\n      label: i18next.t(\"orderShipping.notShipped\")\n    };\n  }\n\n  printableLabels = () => {\n    const { shippingLabelUrl, customsLabelUrl } = getShippingInfo(this.props.order);\n    if (shippingLabelUrl || customsLabelUrl) {\n      return { shippingLabelUrl, customsLabelUrl };\n    }\n\n    return false;\n  }\n\n  render() {\n    return (\n      <CardGroup>\n        <Card>\n          <CardHeader\n            actAsExpander={false}\n            i18nKeyTitle=\"admin.orderWorkflow.summary.cardTitle\"\n            title=\"Summary\"\n          />\n          <CardBody expandable={false}>\n            <OrderSummary\n              {...this.props}\n              dateFormat={this.dateFormat}\n              tracking={this.tracking}\n              shipmentStatus={this.shipmentStatus}\n              printableLabels={this.printableLabels}\n            />\n          </CardBody>\n        </Card>\n      </CardGroup>\n    );\n  }\n}\n\nconst composer = (props, onData) => {\n  const query = { _id: props.orderId };\n  const options = { limit: 1, skip: 0 };\n  const orderSub = Meteor.subscribe(\"PaginatedOrders\", query, options);\n\n  if (orderSub.ready()) {\n    // Find current order\n    const order = Orders.findOne({\n      \"_id\": props.orderId,\n      \"shipping._id\": props.fulfillment && props.fulfillment._id\n    });\n\n    if (order) {\n      const profileShippingAddress = getShippingInfo(order).address || {};\n\n      if (order.workflow) {\n        if (order.workflow.status === \"coreOrderCreated\") {\n          order.workflow.status = \"coreOrderCreated\";\n          Meteor.call(\"workflow/pushOrderWorkflow\", \"coreOrderWorkflow\", \"coreOrderCreated\", order);\n        }\n      }\n\n      onData(null, {\n        order,\n        profileShippingAddress\n      });\n    } else {\n      onData(null, {\n        order: {},\n        profileShippingAddress: {}\n      });\n    }\n  }\n};\n\nexport default composeWithTracker(composer)(withMoment(OrderSummaryContainer));\n"]},"sourceType":"script","hash":"8a3a2ba91914d2f972498b70d5cd94fc15adcd9f"}
